<?xml-model href="./FactDictionaryModule.rng"?>
<FactDictionaryModule>
  <Facts>

    <Fact path="/w2NonstandardCorrectedOptions">
      <Name>Form W2 Nonstandard and/or Corrected Options</Name>
      <Description>Options for the filer to say whether a W2 is nonstandard, corrected, both, or
        neither</Description>
      <Derived>
        <EnumOptions>
          <String>nonstandard</String>
          <String>corrected</String>
          <String>both</String>
          <String>neither</String>
        </EnumOptions>
      </Derived>
    </Fact>

    <Fact path="/w2Box12CodeOptions">
      <Name>Form W-2 Box 12 codes options</Name>
      <Description>Options for form type</Description>
      <Derived>
        <EnumOptions>
          <String>uncollectedOasdiTaxOnTips</String>
          <String>uncollectedMedicareTaxOnTips</String>
          <String>taxableLifeInsuranceOver50k</String>
          <String>401kDeferrals</String>
          <String>403bDeferrals</String>
          <String>sarsepDeferrals</String>
          <String>457bDeferrals</String>
          <String>501c18Deferrals</String>
          <String>nontaxableSickPay</String>
          <String>goldenParachuteExciseTax</String>
          <String>expenseReimbursements</String>
          <String>uncollectedOasdiTaxOnLifeInsuranceOver50k</String>
          <String>uncollectedMedicareTaxOnLifeInsuranceOver50k</String>
          <String>armedForcesMovingExpenses</String>
          <String>writableCombatPay</String>
          <String>archerMsaContributions</String>
          <String>simpleContributions</String>
          <String>adoptionBenefits</String>
          <String>nsoIncome</String>
          <String>employerHsaContributions</String>
          <String>409aDeferrals</String>
          <String>nqdcDeferrals</String>
          <String>roth401kContributions</String>
          <String>roth403bContributions</String>
          <String>healthCoverageCost</String>
          <String>roth457bContributions</String>
          <String>qsehraBenefits</String>
          <String>83iIncome</String>
          <String>83iDeferrals</String>
          <String>nonTaxableMedicaidWaiverPayments</String>
        </EnumOptions>
      </Derived>
    </Fact>

    <Fact path="/box14NYCodeOptions">
      <Name>Box 14 New York Code Options</Name>
      <Description>The codes New York requires for box 14</Description>
      <Derived>
        <EnumOptions>
          <String>hasOtherBox14Code</String>
          <String>414_H</String>
          <String>414_H_CU</String>
          <String>414H</String>
          <String>414HCU</String>
          <String>414HSUB</String>
          <String>ADDITIONAL_MEDICARE_TAX</String>
          <String>ERS</String>
          <String>ERSNYSRE</String>
          <String>ERSRETCO</String>
          <String>IRC125S</String>
          <String>MEDICARE_TAX</String>
          <String>NYRET</String>
          <String>NYSERS</String>
          <String>NYSRETCO</String>
          <String>PUBRET</String>
          <String>RET</String>
          <String>RETDEF</String>
          <String>RETMT</String>
          <String>RETSH</String>
          <String>RETSM</String>
          <String>RETSUM</String>
          <String>RRTA_COMPENSATION</String>
          <String>TIER_1_TAX</String>
          <String>TIER_2_TAX</String>
          <String>TIER3RET</String>
          <String>TIER4</String>
          <String>TIER4RET</String>
        </EnumOptions>
      </Derived>
    </Fact>

    <Fact path="/box14MDCodeOptions">
      <Name>Box 14 Maryland Code Options</Name>
      <Description>The codes Maryland requires for box 14</Description>
      <Derived>
        <EnumOptions>
          <String>hasOtherBox14Code</String>
          <String>ADDITIONAL_MEDICARE_TAX</String>
          <String>MEDICARE_TAX</String>
          <String>RRTA_COMPENSATION</String>
          <String>TIER_1_TAX</String>
          <String>TIER_2_TAX</String>
          <String>BOX14_MD_STPICKUP</String>
        </EnumOptions>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_MD_STPICKUP">
      <Name>Box 14 code BOX14_MD_STPICKUP</Name>
      <Description>Box 14 code BOX14_MD_STPICKUP, used by Maryland</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/BOX14_MD_STPICKUPNeeded">
      <Name>Box 14 code BOX14_MD_STPICKUP needed</Name>
      <Description>Box 14 code BOX14_MD_STPICKUP, used by Maryland</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../BOX14_MD_STPICKUP" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_MD_STPICKUPRounded">
      <Name>Box 14 code BOX14_MD_STPICKUP</Name>
      <Description>Box 14 code BOX14_MD_STPICKUP, used by Maryland</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../BOX14_MD_STPICKUP" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/box14NJCodeOptions">
      <Name>Box 14 New Jersey Code Options</Name>
      <Description>The codes New Jersey requires for box 14</Description>
      <Derived>
        <EnumOptions>
          <String>hasOtherBox14Code</String>
          <String>ADDITIONAL_MEDICARE_TAX</String>
          <String>BOX14_NJ_FLI</String>
          <String>MEDICARE_TAX</String>
          <String>RRTA_COMPENSATION</String>
          <String>TIER_1_TAX</String>
          <String>TIER_2_TAX</String>
          <String>BOX14_NJ_UIHCWD</String>
          <String>BOX14_NJ_UIWFSWF</String>
        </EnumOptions>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_FLI">
      <Name>Box 14 code BOX14_NJ_FLI</Name>
      <Description>Box 14 code BOX14_NJ_FLI, used by New Jersey</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_FLINeeded">
      <Name>Box 14 code BOX14_NJ_FLI needed</Name>
      <Description>Box 14 code BOX14_NJ_FLI, used by New Jersey</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../BOX14_NJ_FLI" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_FLIRounded">
      <Name>Box 14 code BOX14_NJ_FLI</Name>
      <Description>Box 14 code BOX14_NJ_FLI, used by New Jersey</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../BOX14_NJ_FLI" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_UIHCWD">
      <Name>Box 14 code BOX14_NJ_UIHCWD</Name>
      <Description>Box 14 code BOX14_NJ_UIHCWD, used by New Jersey</Description>
      <Export stateSystems="true" />


      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_UIHCWDNeeded">
      <Name>Box 14 code BOX14_NJ_UIHCWD needed</Name>
      <Description>Box 14 code BOX14_NJ_UIHCWD, used by New Jersey</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../BOX14_NJ_UIHCWD" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_UIHCWDRounded">
      <Name>Box 14 code BOX14_NJ_UIHCWD</Name>
      <Description>Box 14 code BOX14_NJ_UIHCWD, used by New Jersey</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../BOX14_NJ_UIHCWD" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_UIWFSWF">
      <Name>Box 14 code BOX14_NJ_UIWFSWF</Name>
      <Description>Box 14 code BOX14_NJ_UIWFSWF, used by New Jersey</Description>
      <Export stateSystems="true" />

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_UIWFSWFNeeded">
      <Name>Box 14 code BOX14_NJ_UIWFSWF needed</Name>
      <Description>Box 14 code BOX14_NJ_UIWFSWF, used by New Jersey</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../BOX14_NJ_UIWFSWF" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/BOX14_NJ_UIWFSWFRounded">
      <Name>Box 14 code BOX14_NJ_UIWFSWF</Name>
      <Description>Box 14 code BOX14_NJ_UIWFSWF, used by New Jersey</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../BOX14_NJ_UIWFSWF" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/w2MinAmount">
      <Name>W2 Minimum Amount</Name>
      <Description>The minimum amount of pay before an employer needs to issue a W2</Description>
      <Derived>
        <Dollar>600</Dollar>
      </Derived>
    </Fact>

    <Fact path="/maxMFSMedicareWages">
      <Name>Maximum Medicare Wages for an MFS Filer</Name>
      <Description>The maximum medicare wages (W-2 Box 5) a MFS filer might have without possibly
        needing to pay
        Additional Medicare Tax</Description>
      <Derived>
        <Dollar>125000</Dollar>
      </Derived>
    </Fact>

    <Fact path="/maxMFJMedicareWages">
      <Name>Maximum Medicare Wages for an MRJ Filer</Name>
      <Description>The maximum medicare wages (W-2 Box 5) a MFS filer might have without possibly
        needing to pay
        Additional Medicare Tax</Description>
      <Derived>
        <Dollar>250000</Dollar>
      </Derived>
    </Fact>

    <Fact path="/maxNonMFSorMFJMedicareWages">
      <Name>Maximum Medicare Wages for non-MFS Filer</Name>
      <Description>The maximum medicare wages (W-2 Box 5) filers with a status other than MFS might
        have without
        possibly
        needing to pay Additional Medicare Tax</Description>
      <Derived>
        <Dollar>200000</Dollar>
      </Derived>
    </Fact>

    <Fact path="/maxIndividualMedicareWages">
      <Name>Maximum Medicare Wages for non-MFS Filer</Name>
      <Description>The maximum medicare wages (W-2 Box 5) any individual on a return could have
        before needing to pay
        Additonal Medicare Tax</Description>
      <Derived>
        <Dollar>200000</Dollar>
      </Derived>
    </Fact>


    <Fact path="/maxOasdiWagesOnMultipleW2sForOnePerson">
      <Name>Maximum Social Security Wages On Multiple W2s for one person</Name>
      <Description>The limit of Social Security Wages that one filer can have across multiple W2s
        before they might be
        entitely to a refund on social security payments.
        https://www.ssa.gov/oact/cola/cbb.html
      </Description>
      <TaxYear>2024</TaxYear>
      <Derived>
        <Dollar>168600</Dollar>
      </Derived>
    </Fact>

    <Fact path="/formW2s">
      <Name>Form W-2s</Name>
      <Description>Form W-2: Wage and Tax Statement, used to report wage income and withholding.</Description>
      <Export downstreamFacts="true" />

      <Writable>
        <Collection />
      </Writable>
    </Fact>

    <Fact path="/formW2sIsDone">
      <Name>formW2s is Done</Name>
      <Description>The user has clicked "Done" for their formW2s</Description>
      <Export downstreamFacts="true" />
      <Writable>
        <Boolean />
      </Writable>
      <Placeholder>
        <False />
      </Placeholder>
    </Fact>

    <Fact path="/primaryFilerHasIncompleteFormW2s">
      <Name>At least one of Primary Filer's Form W2s are incomplete</Name>
      <Description>Whether at least one of Primary Filer's Form W2s are incomplete</Description>
      <BlockSubmissionOnTrue />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <All>
                <Dependency path="/formW2s/*/belongsToPrimaryFiler" />
                <Not>
                  <Dependency path="/formW2s/*/isComplete" />
                </Not>
              </All>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerHasIncompleteFormW2s">
      <Name>At least one of Secondary Filer's Form W2s are incomplete</Name>
      <Description>Whether at least one of Secondary Filer's Form W2s are incomplete</Description>
      <BlockSubmissionOnTrue />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <All>
                <Dependency path="/formW2s/*/belongsToSecondaryFiler" />
                <Not>
                  <Dependency path="/formW2s/*/isComplete" />
                </Not>
              </All>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/hasW2s">
      <Name>Has W-2s</Name>
      <Description>Whether the TP has any W2s listed</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <CollectionSize>
              <Dependency path="/formW2s" />
            </CollectionSize>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/xmlHasW2s">
      <Name>Has W-2s</Name>
      <Description>Whether the TP has any W2s listed. This fact will either be true or empty.</Description>
      <Export mef="true" />
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="formW2s" path="/hasW2s" />
            </When>
            <Then>
              <True></True>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutAllocatedTips">
      <Name>Knockout Due to W2 Income</Name>
      <Description>At least one W2 has a set of facts that cause a knockout</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/causesAllocatedTipsKO" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutStatutoryEmployee">
      <Name>Knockout Due to Being Statutory Employee</Name>
      <Description>The TP requires statutory employee forms that we don't support</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/statutoryEmployee" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutThirdPartySickPay">
      <Name>Knockout Due to Third Party Sick Pay</Name>
      <Description>The TP requires third party sick pay forms that we don't support</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/thirdPartySickPay" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/flowStateToolNeedsBox14">
      <Name>The filer(s) lives in a state that requests Box 14 data</Name>
      <Description>Whether we ask about the contents of box 14 because the integrated state
        tool needs it.</Description>

      <Derived>
        <Any>
          <Dependency module="filers" path="/livedInMd"></Dependency>
          <Dependency module="filers" path="/livedInNj"></Dependency>
          <Dependency module="filers" path="/livedInNy"></Dependency>
        </Any>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasRRTACodesInBox14">
      <Name>Has RRTA codes in Box 14</Name>

      <Derived>
        <All>
          <GreaterThan>
            <Left>
              <Count>
                <All>
                  <Dependency path="../hasRRTACodes" />
                  <Dependency path="../hasBox14Codes" />
                </All>
              </Count>
            </Left>
            <Right>
              <Int>0</Int>
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutHasRRTACodesInBox14NotInNY">
      <Name>Knockout Due to having RRTA codes in Box 14</Name>
      <Description>Knockout Due to having RRTA codes in Box 14</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <GreaterThan>
            <Left>
              <CollectionSize>
                <Filter path="/formW2s">
                  <Dependency path="hasRRTACodesInBox14" />
                </Filter>
              </CollectionSize>
            </Left>
            <Right>
              <Int>0</Int>
            </Right>
          </GreaterThan>
          <Not>
            <Dependency module="filers" path="/livedInNy"></Dependency>
          </Not>
        </All>
      </Derived>
    </Fact>

    <Fact path="/medicareWagesAdditionalTaxThreshhold">
      <Name>Medicare Wages Additonal Tax Threshhold</Name>
      <Description>The filing-status based threshold at which a filer might need to pay aditional
        medicare taxes and
        thereby requires form 8959</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="filingStatus" path="/isFilingStatusMFS" />
            </When>
            <Then>
              <Dependency path="/maxMFSMedicareWages" />
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
            </When>
            <Then>
              <Dependency path="/maxMFJMedicareWages" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency path="/maxNonMFSorMFJMedicareWages" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/knockoutMedicareWages">
      <Name>Knockout if Medicare Wages Great Than Max for filing status</Name>
      <Description>Knockout the filer if their total medicare wages are above the limit for their
        filing status that
        might necessitate form 8959</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Any>
          <Dependency path="/anyFilerExceedsEligibleForMedicareWagesCredit" />
          <GreaterThan>
            <Left>
              <Dependency path="/formW2totalMedicareWages" />
            </Left>
            <Right>
              <Dependency path="/medicareWagesAdditionalTaxThreshhold" />
            </Right>
          </GreaterThan>
        </Any>
      </Derived>
    </Fact>


    <Fact path="/primaryFilerExceedsMaxOasdiWages">
      <Name>Primary Filer Exceeds Max Social Security Wages</Name>
      <Description>Does the primary filer have Great Than 1 W-2 and social security wages over the
        limit that might
        entitle them to a socail security refund?</Description>
      <Derived>
        <All>
          <!-- Does the primary filer have multiple W2s -->
          <GreaterThan>
            <Left>
              <Dependency path="/primaryFilerW2sCount"></Dependency>
            </Left>
            <Right>
              <Int>1</Int>
            </Right>
          </GreaterThan>

          <!--  AND do they exceed the income limit? -->
          <GreaterThan>
            <Left>
              <Dependency path="/primaryFilerTotalOasdiWagesForKnockout" />
            </Left>
            <Right>
              <Dependency path="/maxOasdiWagesOnMultipleW2sForOnePerson" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerExceedsMaxOasdiWages">
      <Name>Secondary Filer Exceeds Max Social Security Wages</Name>
      <Description>Does the primary filer have Greater Than 1 W-2 and social security wages over the
        limit that might
        entitle them to a socail security refund?</Description>
      <Derived>
        <All>
          <!-- Does the primary filer have multiple W2s -->
          <GreaterThan>
            <Left>
              <Dependency path="/secondaryFilerW2sCount"></Dependency>
            </Left>
            <Right>
              <Int>1</Int>
            </Right>
          </GreaterThan>

          <!--  AND do they exceed the income limit? -->
          <GreaterThan>
            <Left>
              <Dependency path="/secondaryFilerTotalOasdiWagesForKnockout" />
            </Left>
            <Right>
              <Dependency path="/maxOasdiWagesOnMultipleW2sForOnePerson" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/anyFilerExceedsMaxOasdiWages">
      <Name>Any Filer Exceeds Social Security Wages</Name>
      <Description>Does either filer have Greater Than 1 W-2 and social security wages over the
        limit that might entitle
        them to a social security refund?</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <Any>
          <Dependency path="/primaryFilerExceedsMaxOasdiWages" />
          <Dependency path="/secondaryFilerExceedsMaxOasdiWages" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutNonQualifiedPlans">
      <Description>At least one W2 has non-qualified plan values</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/causesNonQualifiedPlansKO" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>
    <Fact path="/formW2s/*/hasSeenLastAvailableScreen">
      <Name>Has Seen last available screen</Name>
      <Description>Whether the user has seen the last available scren for this W2.</Description>
      <Export downstreamFacts="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/isComplete">
      <Name>Is Complete</Name>
      <Description>Whether the W2 is complete</Description>

      <Derived>
        <All>
          <!-- Sometimes our final screens are optional, so we check that you've seen them rather
            than checking that you've filled them out-->
          <Dependency path="../hasSeenLastAvailableScreen" />
          <IsComplete>
            <Dependency path="../ein" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../employerName" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../employerAddress" />
          </IsComplete>
          <!-- We explicitly check that you have filled out wages and withholding, since they have
            downstream effects and can't be placeholders -->
          <IsComplete>
            <Dependency path="../wages" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../federalWithholding" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../isCorrected" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../isNonstandard" />
          </IsComplete>
          <!-- We need a TIN set -->
          <IsComplete>
            <Dependency path="../usedTin" />
          </IsComplete>

          <!-- Is the address set -->
          <Any>
            <Dependency path="../addressMatchesReturn" />
            <All>
              <Not>
                <Dependency path="../addressMatchesReturn" />
              </Not>
              <IsComplete>
                <Dependency path="../addressOverride" />
              </IsComplete>
            </All>
          </Any>

          <!-- We've clarified gov vs. nongov 457(b) if an amount was provided -->
          <Any>
            <Not>
              <IsComplete>
                <Dependency path="../457bDeferralsNeeded" />
              </IsComplete>
            </Not>
            <Not>
              <Dependency path="../457bDeferralsNeeded" />
            </Not>
            <IsComplete>
              <Dependency path="../457bIsGovernmentalPlan" />
            </IsComplete>
          </Any>
        </All>
      </Derived>
    </Fact>

    <Fact path="/hasW2ValidationErrors">
      <Description>
        Any W-2 has a validation error that should block submission until fixed
      </Description>

      <BlockSubmissionOnTrue />

      <Derived>
        <Any>
          <GreaterThan>
            <Left>
              <Count>
                <Any>
                  <Dependency path="/formW2s/*/box17GreaterThanBox16" />
                  <Dependency path="/formW2s/*/hasStateWagesWithoutStateCode" />
                  <Dependency path="/formW2s/*/box19GreaterThanBox18" />
                </Any>
              </Count>
            </Left>
            <Right>
              <Int>0</Int>
            </Right>
          </GreaterThan>
        </Any>
      </Derived>
    </Fact>

    <Fact path="/oneAndOnlyW2">
      <Description>The w2 when there's only one</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/filersHaveExactlyOneW2" />
            </When>
            <Then>
              <IndexOf>
                <Collection>
                  <Dependency module="formW2s" path="/formW2s" />
                </Collection>
                <Index>
                  <Int>0</Int>
                </Index>
              </IndexOf>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/filersHaveExactlyOneW2">
      <Description>The taxpayer (and spouse) has only one W2. Used for logic in Care provider
        screens.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Equal>
          <Left>
            <CollectionSize>
              <Dependency path="/formW2s" />
            </CollectionSize>
          </Left>
          <Right>
            <Int>1</Int>
          </Right>
        </Equal>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/filer">
      <Name>Employee</Name>
      <Description>The taxpayer who received the W-2.</Description>

      <Writable>
        <CollectionItem collection="/filers" />
      </Writable>
      <Placeholder>
        <Dependency module="filers" path="/primaryFiler" />
      </Placeholder>
    </Fact>

    <Fact path="/formW2s/*/tin">
      <Name>Employee's overwritten TIN</Name>
      <Description>This is written to when the user has a non-SSN TIN which are not allowed on a W2.
        Previously we were
        always using this value instead of ../usedTin</Description>

      <Writable>
        <TIN allowAllZeros="true" />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/usedTin">
      <Name>TIN associated with the form W2</Name>
      <Description>The actual TIN that is used and associated with the W2</Description>
      <Export mef="true" stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../flowFilerTinIsSsn" />
            </When>
            <Then>
              <Dependency module="filers" path="../filer/tin" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency path="../tin" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/flowFilerTinIsSsn">
      <Name>Flow variable for choosing TIN-related screens</Name>
      <Description>Whether the TIN of this W2's filer is an SSN.</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <Dependency module="filingStatus" path="/treatAsMFJ" />
              </Not>
            </When>
            <Then>
              <Dependency module="filers" path="/primaryFiler/tin/isSSN" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency module="filers" path="../filer/tin/isSSN" />
            </Then>
          </Case>

        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ein">
      <Name>Employer identification number</Name>
      <Description>Box b of Form W-2, employer identification number (EIN).</Description>
      <Export mef="true" />

      <Writable>
        <EIN />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/employerName">
      <Name>Employer's name</Name>
      <Description>The employer's name as appears in box c of Form W-2.</Description>
      <Export downstreamFacts="true" />

      <Writable>
        <String />
        <Limit type="Match">
          <!-- N.B. This is not the same regex as employer name line 2! Slashes are not allowed on
          line 1 -->
          <String><![CDATA[(([A-Za-z0-9#\-\(\)]|&|')\s?)*([A-Za-z0-9#\-\(\)]|&|')]]></String>
        </Limit>
        <Limit type="MaxLength">
          <Int>75</Int>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/mefEmployerNameLine1">
      <Name>MeF Employer Name</Name>
      <Description> Employer Name transformed for MeF. This may be removed next year, but right now
        exists to transform
        any data that existed from before we applied limits to ../employerName
      </Description>
      <Export mef="true" />

      <Derived>
        <Trim>
          <StripChars>
            <Input>
              <Dependency path="../employerName" />
            </Input>
            <Allow>
              <Dependency module="mefTypes" path="/mefBusinessNameLine1Type" />
            </Allow>
          </StripChars>
        </Trim>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableEmployerNameLine2">
      <Name>Employer's name line 2</Name>
      <Description>The employer's name as appears in line 2 box c of Form W-2. This is the writable
        optional fact. Can
        be
        left incomplete.Please use the derived fact in downstream calculations</Description>
      <Export mef="true" />

      <Writable>
        <String />
        <Limit type="MaxLength">
          <Int>75</Int>
        </Limit>
        <Limit type="Match">
          <!-- N.B. This is not the same regex as employer name line 1! Slashes are allowed on line
          2 -->
          <String><![CDATA[(([A-Za-z0-9#/%\-\(\)]|&|')\s?)*([A-Za-z0-9#/%\-\(\)]|&|')]]></String>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/employerAddress">
      <Name>Employer's address</Name>
      <Description>The employer's address as appears in box c of Form W-2.</Description>
      <Export mef="true" />

      <Writable>
        <Address />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/mefEmployerAddressZip">
      <Name>Employer's address zip in MeF Format</Name>
      <Description>The employer's address zip, with hyphens and spaces stripped for MeF compliance</Description>
      <Export mef="true" />
      <Derived>
        <Trim>
          <StripChars>
            <Input>
              <Dependency path="../employerAddress/postalCode" />
            </Input>
            <Allow>
              <Dependency module="mefTypes" path="/mefZipCodeType" />
            </Allow>
          </StripChars>
        </Trim>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/suffix">
      <Name>Employee's suffix</Name>
      <Description>The employee's suffix as appears in box e of Form W-2.

        TODO: Enable placeholders to be written a
        normal derived facts
      </Description>

      <Writable>
        <String />
      </Writable>

    </Fact>

    <Fact path="/formW2s/*/addressMatchesReturn">
      <Name>Address on W-2 is same as tax return</Name>
      <Description>Whether Box f of Form W-2 contains the same address as the tax return.</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/addressOverride">
      <Name>Employee's address, if it doesn't match the one on the return</Name>
      <Description>Box f of Form W-2, employee's address and ZIP code override field, likely to be
        incomplete</Description>
      <Writable>
        <Address />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/address">
      <Name>Employee's address</Name>
      <Description>Box f of Form W-2, employee's address and ZIP code override field</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../addressMatchesReturn" />
            </When>
            <Then>
              <Dependency module="filers" path="/address" />
            </Then>
          </Case>
          <Case>
            <When>
              <Not>
                <Dependency path="../addressMatchesReturn" />
              </Not>
            </When>
            <Then>
              <Dependency path="../addressOverride" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/mefAddressZip">
      <Name>Employee's address zip in MeF Format</Name>
      <Description>The employee's address ZIP code, with hyphens and spaces stripped for MeF
        compliance</Description>
      <Export mef="true" />
      <Derived>
        <Trim>
          <StripChars>
            <Input>
              <Dependency path="../address/postalCode" />
            </Input>
            <Allow>
              <Dependency module="mefTypes" path="/mefZipCodeType" />
            </Allow>
          </StripChars>
        </Trim>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableWages">
      <Name>Wages</Name>
      <Description>Box 1 of Form W-2, wages, tips, and other compensation. This is the writable
        optional fact. Can be
        left incomplete. Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/wages">
      <Name>Wages</Name>
      <Description>Box 1 of Form W-2, wages, tips, and other compensation.</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableWages" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableWages" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableFederalWithholding">
      <Name>Federal income tax withheld</Name>
      <Description>Box 2 of Form W-2, Federal income tax withheld.

        This is the writable optional fact. Can be left
        incomplete. Please use the derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/federalWithholding">
      <Name>Federal income tax withheld</Name>
      <Description>Box 2 of Form W-2, Federal income tax withheld.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableFederalWithholding" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableFederalWithholding" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableOasdiWages">
      <Name>Social Security Wages</Name>
      <Description>Box 3 of Form W-2, social security wages.

        This is the writable optional fact. Can be left incomplete.
        Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/oasdiWages">
      <Name>Social security wages</Name>
      <Description>Box 3 of Form W-2, social security wages. Includes non-taxable income, and
        excludes income that
        exceeds the wage cap.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableOasdiWages" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableOasdiWages" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/oasdiWagesForKnockoutCalculation">
      <Description>We knockout filers who have multiple W-2s that sum to
        maxOasdiWagesOnMultipleW2sForOnePerson. To
        prevent filers who have multiple W-2s that don't all have social security wages, we only
        look at the first
        maxOasdiWagesOnMultipleW2sForOnePerson per W-2. So, this fact returns the either oasdiWages
        or
        maxOasdiWagesOnMultipleW2sForOnePerson, whichever is lower</Description>
      <Derived>
        <LesserOf>
          <Dependency path="../oasdiWages" />
          <Dependency path="/maxOasdiWagesOnMultipleW2sForOnePerson" />
        </LesserOf>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableOasdiWithholding">
      <Name>Social Security Tax Withheld</Name>
      <Description>Box 4 of Form W-2, social security tax withheld. This is the writable optional
        fact. Can be left
        incomplete. Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/oasdiWithholding">
      <Name>Social security tax withheld</Name>
      <Description>Box 4 of Form W-2, social security tax withheld.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableOasdiWithholding" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableOasdiWithholding" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableMedicareWages">
      <Name>Medicare Wages</Name>
      <Description>Box 5 of Form W-2, Medicare wages and tips. This is the writable optional fact.
        Can be left
        incomplete. Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/medicareWages">
      <Name>Medicare wages</Name>
      <Description>Box 5 of Form W-2, Medicare wages and tips. Includes non-taxable income.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableMedicareWages" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableMedicareWages" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2totalMedicareWages">
      <Name>Total Medicare Wages</Name>
      <Description>The sum of all medicare wages across Form W-2s</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/formW2s/*/medicareWages"></Dependency>
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerMedicareWages">
      <Description>Medicare Wages for the primary filer</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/primaryFilerW2s/*/medicareWages" />
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerMedicareWages">
      <Description>Medicare wages for the secondary filer</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/secondaryFilerW2s/*/medicareWages" />
        </CollectionSum>
      </Derived>
    </Fact>


    <Fact path="/anyFilerExceedsEligibleForMedicareWagesCredit">
      <Description>Is any filer on the return over the limit that would qualify them for a credit
        for their medicare
        payments. Note this would only trigger if the filers are MFJ, since for non-MFJ filers, the
        limit would trigger
        anyway</Description>
      <Derived>
        <All>
          <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
          <Any>
            <GreaterThan>
              <Left>
                <Dependency path="/primaryFilerMedicareWages" />
              </Left>
              <Right>
                <Dependency path="/maxIndividualMedicareWages" />
              </Right>
            </GreaterThan>
            <GreaterThan>
              <Left>
                <Dependency path="/secondaryFilerMedicareWages" />
              </Left>
              <Right>
                <Dependency path="/maxIndividualMedicareWages" />
              </Right>
            </GreaterThan>
          </Any>
        </All>
      </Derived>
    </Fact>

    <Fact path="/anyFilerRequiredToPayExtraMedicareTax">
      <Description>
        Is any filer over the medicare tax threshhold such that they'd qualify for a refund of some
        of the
        medicare tax they paid.
      </Description>
      <Derived>
        <All>
          <Dependency path="/knockoutMedicareWages" />
          <Any>
            <Not>
              <IsComplete>
                <Dependency path="/anyFilerExceedsEligibleForMedicareWagesCredit" />
              </IsComplete>
            </Not>
            <Not>
              <Dependency path="/anyFilerExceedsEligibleForMedicareWagesCredit" />
            </Not>
          </Any>
        </All>
      </Derived>
    </Fact>

    <Fact path="/maxMedicareWagesForAnyFilerOnReturn">
      <Description>The highest medicare wages a single person on the return recieved</Description>
      <Derived>
        <GreaterOf>
          <Dependency path="/primaryFilerMedicareWages" />
          <Dependency path="/secondaryFilerMedicareWages" />
        </GreaterOf>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableMedicareWithholding">
      <Name>Medicare Tax Withheld</Name>
      <Description>Box 6 of Form W-2, Medicare tax withheld. This is the writable optional fact. Can
        be left incomplete.
        Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/medicareWithholding">
      <Name>Medicare tax withheld</Name>
      <Description>Box 6 of Form W-2, Medicare tax withheld.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableMedicareWithholding" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableMedicareWithholding" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableOasdiTips">
      <Name>Social Security Tips</Name>
      <Description>Box 7 of Form W-2, social security tips. This is the writable optional fact. Can
        be left incomplete.
        Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/oasdiTips">
      <Name>Social security tips</Name>
      <Description>Box 7 of Form W-2, social security tips.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableOasdiTips" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableOasdiTips" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableAllocatedTips">
      <Name>Allocated Tips</Name>
      <Description>Box 8 of Form W-2, allocated tips.
        This is the writable optional fact. Can be left incomplete. Please
        use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/allocatedTips">
      <Name>Allocated tips</Name>
      <Description>Box 8 of Form W-2, allocated tips. You may have an amount here if you receive
        tips at your job, but
        the amount of tips you reported falls below a certain percentage of food and drink sales
        (typically 8%).
        Allocated tips will need to be included as unreported tip income, unless you have adequate
        records to show that
        you received less than the allocated amount.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableAllocatedTips" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableAllocatedTips" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>


    <Fact path="/formW2s/*/causesAllocatedTipsKO">
      <Name>W2 Scope Knockout</Name>
      <Description>Information on this W2 knocks the filer out of scope</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../allocatedTips" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2WithAllocatedTips">
      <Name>The "first" W2 with allocated tips</Name>
      <Derived>
        <IndexOf>
          <Collection>
            <Filter path="/formW2s">
              <Dependency path="causesAllocatedTipsKO"></Dependency>
            </Filter>
          </Collection>
          <Index>
            <Int>0</Int>
          </Index>
        </IndexOf>
      </Derived>
    </Fact>


    <Fact path="/formW2s/*/causesDependentCareBenefitsKO">
      <Name>W2 Scope Knockout</Name>
      <Description>Information on this W2 knocks the filer out of scope</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../dependentCareBenefits" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>


    <Fact path="/formW2s/*/causesNonQualifiedPlansKO">
      <Description>W2 Scope Knockout for Box 11 (nonqualified plans)</Description>
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../nonQualifiedPlans" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableDependentCareBenefits">
      <Name>Writable Dependent Care Benefits</Name>
      <Description>Box 10 of Form W-2, dependent care benefits.

        This is the writable optional fact. Can be left
        incomplete. Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/dependentCareBenefits">
      <Name>Dependent care benefits</Name>
      <Description>Box 10 of Form W-2, dependent care benefits. Amounts over $5,000 are included in
        box 1. Requires Form
        2441, Child and Dependent Care Expenses to determine the taxable amount.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableDependentCareBenefits" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableDependentCareBenefits" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerDependentCareBenefits">
      <Name>All primary filer dependent care benefits</Name>
      <Description>
        The sum of Box 10 of all primary filers form W-2s, dependent care benefits. Used for form
        2441, Child
        and Dependent Care Expenses to determine the taxable amount.
      </Description>

      <Derived>
        <Round>
          <CollectionSum>
            <Dependency path="/primaryFilerW2s/*/dependentCareBenefits" />
          </CollectionSum>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerDependentCareBenefits">
      <Name>All secondary filer dependent care benefits</Name>
      <Description>
        The sum of Box 10 of all secondary filers form W-2s, dependent care benefits. Used for form
        2441,
        Child and Dependent Care Expenses to determine the taxable amount.
      </Description>

      <Derived>
        <Round>
          <CollectionSum>
            <Dependency path="/secondaryFilerW2s/*/dependentCareBenefits" />
          </CollectionSum>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableNonQualifiedPlans">
      <Name>Non-qualified Plans</Name>
      <Description>Box 11 of Form W-2, non-qualified plans.

        This is the writable optional fact. Can be left incomplete.
        Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/nonQualifiedPlans">
      <Name>Non-qualified plans</Name>
      <Description>Box 11 of Form W-2, non-qualified plans. These are retirement plans not covered
        by the Employee
        Retirement Income Security Act (ERISA). This compensation is excluded from box 1, but it is
        included in FICA
        wages.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableNonQualifiedPlans" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableNonQualifiedPlans" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRounded401kDeferrals">
      <Description>Rounded 401k deferrals values if they exist or 0, used so that we can easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../401kDeferrals"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../401kDeferralsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRounded403bDeferrals">
      <Description>Rounded 403b deferrals values if they exist or 0, used so that we can easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../403bDeferrals"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../403bDeferralsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRoundedSarsepDeferrals">
      <Description>Rounded SARSEP deferrals values if they exist or 0, used so that we can easily
        sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../sarsepDeferrals"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../sarsepDeferralsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRounded457bDeferrals">
      <Description>Rounded 457b deferrals values if they exist or 0, used so that we can easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../457bDeferrals"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../457bDeferralsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRounded501c18Deferrals">
      <Description>Rounded 501(c)(18)(D) deferrals values if they exist or 0, used so that we can
        easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../501c18Deferrals"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../501c18DeferralsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRoundedSimpleContributions">
      <Description>Rounded SIMPLE contribution values if they exist or 0, used so that we can easily
        sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../simpleContributions"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../simpleContributionsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRoundedRoth401kContributions">
      <Description>Rounded Roth 401k contribution values if they exist or 0, used so that we can
        easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../roth401kContributions"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../roth401kContributionsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRoundedRoth403bContributions">
      <Description>Rounded Roth 403b contribution values if they exist or 0, used so that we can
        easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../roth403bContributions"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../roth403bContributionsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/normalizedRoundedRoth457bContributions">
      <Description>Rounded Roth 457b contribution values if they exist or 0, used so that we can
        easily sum</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../roth457bContributions"></Dependency>
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../roth457bContributionsRounded"></Dependency>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/totalDeferralsAndContributions">
      <Description>Summation of all deferrals and contributions, used as part of the calculation for
        Form 8880 Line 2</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <Add>
          <Dependency path="../normalizedRounded401kDeferrals" />
          <Dependency path="../normalizedRounded403bDeferrals" />
          <Dependency path="../normalizedRoundedSarsepDeferrals" />
          <!-- Only include Code G if it is a governmental 457(b) plan-->
          <Switch>
            <Case>
              <When>
                <All>
                  <IsComplete>
                    <Dependency path="../457bIsGovernmentalPlan" />
                  </IsComplete>
                  <Dependency path="../457bIsGovernmentalPlan" />
                </All>
              </When>
              <Then>
                <Dependency path="../normalizedRounded457bDeferrals" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
          <Dependency path="../normalizedRounded501c18Deferrals" />
          <Dependency path="../normalizedRoundedSimpleContributions" />
          <Dependency path="../normalizedRoundedRoth401kContributions" />
          <Dependency path="../normalizedRoundedRoth403bContributions" />
          <Dependency path="../normalizedRoundedRoth457bContributions" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/457bIsGovernmentalPlan">
      <Name>457(b) is governmental plan</Name>
      <Description>The 457(b) plan to which the filer contributed is a governmental 457(b).</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/hasInputBox12Codes">
      <Name>Filer has input Box 12 Codes for this W2</Name>
      <Description>Whether filer has input any box 12 codes for this W2</Description>

      <Derived>
        <Any>
          <IsComplete>
            <Dependency path="../uncollectedOasdiTaxOnTips" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../uncollectedMedicareTaxOnTips" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../taxableLifeInsuranceOver50k" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../401kDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../403bDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../sarsepDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../457bDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../501c18Deferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../nontaxableSickPay" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../goldenParachuteExciseTax" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../expenseReimbursements" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../uncollectedOasdiTaxOnLifeInsuranceOver50k" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../uncollectedMedicareTaxOnLifeInsuranceOver50k" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../armedForcesMovingExpenses" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../writableCombatPay" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../archerMsaContributions" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../simpleContributions" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../adoptionBenefits" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../nsoIncome" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../employerHsaContributions" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../409aDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../nqdcDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../roth401kContributions" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../roth403bContributions" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../healthCoverageCost" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../roth457bContributions" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../qsehraBenefits" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../83iIncome" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../83iDeferrals" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../nonTaxableMedicaidWaiverPayments" />
          </IsComplete>
        </Any>
      </Derived>
    </Fact>
    <Fact path="/formW2s/*/writableHasBox12Codes">
      <Name>W2 has Box 12 Codes</Name>
      <Description>Whether this W2 has any codes or amounts in box 12</Description>

      <Writable>
        <Boolean />
      </Writable>

      <Placeholder>
        <!-- We only want to set a placeholder if the user has already seen the last screen -->
        <Switch>
          <Case>
            <When>
              <Dependency path="../hasSeenLastAvailableScreen" />
            </When>
            <Then>
              <Dependency path="../hasInputBox12Codes" />
            </Then>
          </Case>
        </Switch>
      </Placeholder>
    </Fact>

    <Fact path="/formW2s/*/hasBox12Codes">
      <Name>W2 has Box 12 Codes</Name>
      <Description>Whether this W2 has any codes or amounts in box 12</Description>

      <Derived>
        <Any>
          <Dependency path="../hasInputBox12Codes" />
          <Dependency path="../writableHasBox12Codes" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableBox12Code">
      <Name>Flow variable for Box 12 codes.</Name>
      <Description>The Box 12 code currently selected in the UI.</Description>

      <Writable>
        <Enum optionsPath='/w2Box12CodeOptions' />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/uncollectedOasdiTaxOnTips">
      <Name>Uncollected social security or RRTA tax on tips</Name>
      <Description>Box 12, code A.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/uncollectedOasdiTaxOnTipsNeeded">
      <Name>Uncollected social security or RRTA tax on tips needed</Name>
      <Description>Box 12, code A.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../uncollectedOasdiTaxOnTips" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedOasdiTaxOnTipsRounded">
      <Name>Uncollected social security or RRTA tax on tips</Name>
      <Description>Box 12, code A.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../uncollectedOasdiTaxOnTips" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedMedicareTaxOnTips">
      <Name>Uncollected Medicare tax on tips (but not Additional Medicare Tax)</Name>
      <Description>Box 12, code B.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/uncollectedMedicareTaxOnTipsNeeded">
      <Name>Uncollected Medicare tax on tips (but not Additional neededMedicare Tax)</Name>
      <Description>Box 12, code B.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../uncollectedMedicareTaxOnTips" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedMedicareTaxOnTipsRounded">
      <Name>Uncollected Medicare tax on tips (but not Additional Medicare Tax)</Name>
      <Description>Box 12, code B.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../uncollectedMedicareTaxOnTips" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/taxableLifeInsuranceOver50k">
      <Name>Taxable cost of group-term life insurance over $50,000</Name>
      <Description>Box 12, code C.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/taxableLifeInsuranceOver50kNeeded">
      <Name>Taxable cost of group-term life insurance over $50 needed,000</Name>
      <Description>Box 12, code C.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../taxableLifeInsuranceOver50k" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/taxableLifeInsuranceOver50kRounded">
      <Name>Taxable cost of group-term life insurance over $50,000</Name>
      <Description>Box 12, code C.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../taxableLifeInsuranceOver50k" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/401kDeferrals">
      <Name>Elective deferrals under a section 401(k) cash or deferred arrangement plan (including a
        SIMPLE
        401(k)arrangement)</Name>
      <Description>Box 12, code D.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/401kDeferralsNeeded">
      <Name>Elective deferrals under a section needed401(k) cash or deferred arrangement plan
        (including a SIMPLE
        401(k)arrangement)</Name>
      <Description>Box 12, code D.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../401kDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/401kDeferralsRounded">
      <Name>Elective deferrals under a section 401(k) cash or deferred arrangement plan (including a
        SIMPLE 401(k)
        arrangement)</Name>
      <Description>Box 12, code D.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../401kDeferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/403bDeferrals">
      <Name>Elective deferrals under a section 403(b) salary Q reduction agreement</Name>
      <Description>Box 12, code E.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/403bDeferralsNeeded">
      <Name>Elective deferrals under a section needed401(k) cash or deferred arrangement plan
        (including a SIMPLE
        401(k)arrangement)</Name>
      <Description>Box 12, code D.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../403bDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/403bDeferralsRounded">
      <Name>Elective deferrals under a section 403(b) salary Q reduction agreement</Name>
      <Description>Box 12, code E.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../403bDeferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/sarsepDeferrals">
      <Name>Elective deferrals under a section 408(k)(6) salary reduction SEP</Name>
      <Description>Box 12, code F.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/sarsepDeferralsNeeded">
      <Name>Elective deferrals under a section 408 needed(k)(6) salary reduction SEP</Name>
      <Description>Box 12, code F.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../sarsepDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/sarsepDeferralsRounded">
      <Name>Elective deferrals under a section 408(k)(6) salary reduction SEP</Name>
      <Description>Box 12, code F.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../sarsepDeferrals" />
        </Round>
      </Derived>
    </Fact>


    <Fact path="/formW2s/*/457bDeferrals">
      <Name>Elective deferrals and employer contributions (including nonelective deferrals) to a
        section 457(b) deferred
        compensation plan</Name>
      <Description>Box 12, code G.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/457bDeferralsNeeded">
      <Name>Elective deferrals and employer contributions (including nonelective deferrals) to a
        section 457(b) deferred
        compensation plan</Name>
      <Description>Box 12, code G.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../457bDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/457bDeferralsRounded">
      <Name>Elective deferrals and employer contributions (including nonelective deferrals) to a
        section 457(b) deferred
        compensation plan</Name>
      <Description>Box 12, code G.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../457bDeferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/501c18Deferrals">
      <Name>Elective deferrals to a section 501(c)(18)(D) tax-exempt organization plan</Name>
      <Description>Box 12, code H. (Only 6% of employers who use this code actually contributed to a
        501(c)(18) plan.)</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/501c18DeferralsNeeded">
      <Name>Elective deferrals to a section 501(c needed)(18)(D) tax-exempt organization plan</Name>
      <Description>Box 12, code H. (Only 6% of employers who use this code actually contributed to a
        501(c)(18) plan.)</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../501c18Deferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/501c18DeferralsRounded">
      <Name>Elective deferrals to a section 501(c)(18)(D) tax-exempt organization plan</Name>
      <Description>Box 12, code H. (Only 6% of employers who use this code actually contributed to a
        501(c)(18) plan.)</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../501c18Deferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nontaxableSickPay">
      <Name>Nontaxable sick pay</Name>
      <Description>Box 12, code J.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/nontaxableSickPayNeeded">
      <Name>Nontaxable sick pay</Name>
      <Description>Box 12, code J.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../nontaxableSickPay" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nontaxableSickPayRounded">
      <Name>Nontaxable sick pay</Name>
      <Description>Box 12, code J.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../nontaxableSickPay" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/goldenParachuteExciseTax">
      <Name>20% excise tax on excess golden parachute payments</Name>
      <Description>Box 12, code K.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/goldenParachuteExciseTaxNeeded">
      <Name>20% excise tax on excess golden parachute payments needed</Name>
      <Description>Box 12, code K.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../goldenParachuteExciseTax" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/goldenParachuteExciseTaxRounded">
      <Name>20% excise tax on excess golden parachute payments</Name>
      <Description>Box 12, code K.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../goldenParachuteExciseTax" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/expenseReimbursements">
      <Name>Substantiated employee business expense reimbursements</Name>
      <Description>Box 12, code L.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/expenseReimbursementsNeeded">
      <Name>Substantiated employee business expense reimbursements needed</Name>
      <Description>Box 12, code L.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../expenseReimbursements" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/expenseReimbursementsRounded">
      <Name>Substantiated employee business expense reimbursements</Name>
      <Description>Box 12, code L.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../expenseReimbursements" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedOasdiTaxOnLifeInsuranceOver50k">
      <Name>Uncollected social security or RRTA tax on taxable cost of group-term life insurance
        over $50,000 (former
        employees only)</Name>
      <Description>Box 12, code M.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/uncollectedOasdiTaxOnLifeInsuranceOver50kNeeded">
      <Name>Uncollected social security or RRTA tax on taxable cost of group needed-term life
        insurance over $50,000
        (former employees only)</Name>
      <Description>Box 12, code M.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../uncollectedOasdiTaxOnLifeInsuranceOver50k" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedOasdiTaxOnLifeInsuranceOver50kRounded">
      <Name>Uncollected social security or RRTA tax on taxable cost of group-term life insurance
        over $50,000 (former
        employees only)</Name>
      <Description>Box 12, code M.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../uncollectedOasdiTaxOnLifeInsuranceOver50k" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedMedicareTaxOnLifeInsuranceOver50k">
      <Name>Uncollected Medicare tax on taxable cost of group-term life insurance over $50,000 (but
        not Additional
        Medicare Tax) (former employees only)</Name>
      <Description>Box 12, code N.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/uncollectedMedicareTaxOnLifeInsuranceOver50kNeeded">
      <Name>Uncollected Medicare tax on taxable cost of group-term life insurance over $50,000 (but
        not Additional
        Medicare Tax) (former employees only)</Name>
      <Description>Box 12, code N.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../uncollectedMedicareTaxOnLifeInsuranceOver50k" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/uncollectedMedicareTaxOnLifeInsuranceOver50kRounded">
      <Name>Uncollected Medicare tax on taxable cost of group-term life insurance over $50,000 (but
        not Additional
        Medicare Tax) (former employees only)</Name>
      <Description>Box 12, code N.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../uncollectedMedicareTaxOnLifeInsuranceOver50k" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/armedForcesMovingExpenses">
      <Name>Excludable moving expense reimbursements paid directly to members of the Armed Forces</Name>
      <Description>Box 12, code P.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/armedForcesMovingExpensesNeeded">
      <Name>Excludable moving expense reimbursements paid directly needed to members of the Armed
        Forces</Name>
      <Description>Box 12, code P.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../armedForcesMovingExpenses" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/armedForcesMovingExpensesRounded">
      <Name>Excludable moving expense reimbursements paid directly to members of the Armed Forces</Name>
      <Description>Box 12, code P.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../armedForcesMovingExpenses" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/knockoutBox12Code">
      <Name>Knockout Box 12 Code</Name>
      <Description>Which of the box 12 codes that can knock a filer out have a positive value. Used
        to give the filer
        information which code knocked them out (and stays incomplete if the filer doesn't have a
        code that knocks them
        out)</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../uncollectedMedicareTaxOnLifeInsuranceOver50k" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../uncollectedMedicareTaxOnLifeInsuranceOver50k" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">uncollectedMedicareTaxOnLifeInsuranceOver50k</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../nqdcDeferrals" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../nqdcDeferrals" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">nqdcDeferrals</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../adoptionBenefits" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../adoptionBenefits" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">adoptionBenefits</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../expenseReimbursements" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../expenseReimbursements" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">expenseReimbursements</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../archerMsaContributions" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../archerMsaContributions" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">archerMsaContributions</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../sarsepDeferrals" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../sarsepDeferrals" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">sarsepDeferrals</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../goldenParachuteExciseTax" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../goldenParachuteExciseTax" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">goldenParachuteExciseTax</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../uncollectedOasdiTaxOnTips" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../uncollectedOasdiTaxOnTips" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">uncollectedOasdiTaxOnTips</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../uncollectedOasdiTaxOnLifeInsuranceOver50k" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../uncollectedOasdiTaxOnLifeInsuranceOver50k" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">uncollectedOasdiTaxOnLifeInsuranceOver50k</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../uncollectedMedicareTaxOnTips" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../uncollectedMedicareTaxOnTips" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">uncollectedMedicareTaxOnTips</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../armedForcesMovingExpenses" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../armedForcesMovingExpenses" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">armedForcesMovingExpenses</Enum>
            </Then>
          </Case>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../nontaxableSickPay" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../nontaxableSickPay" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">nontaxableSickPay</Enum>
            </Then>
          </Case>

          <Case>
          <!-- NOTE: if you remove this KO be sure to add the XML mapping to IRSW2 in the code generator support it (the 2025 schema does support II yet) -->
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../nonTaxableMedicaidWaiverPayments" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../nonTaxableMedicaidWaiverPayments" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/w2Box12CodeOptions">nonTaxableMedicaidWaiverPayments</Enum>
            </Then>
          </Case>

        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasBox12KnockoutCode">
      <Name>Box 12 Knockout</Name>
      <Description>Do any of the codes for box 12 that can knock a tax payer out have a positive
        value</Description>
      <Derived>
        <IsComplete>
          <Dependency path="../knockoutBox12Code" />
        </IsComplete>
      </Derived>
    </Fact>

    <Fact path="/formW2sWithBox12KnockoutCodes">
      <Description>A collection of W2s that have a Box 12 code we knockout</Description>
      <Derived>
        <Filter path="/formW2s">
          <Dependency path="hasBox12KnockoutCode"></Dependency>
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/formW2WithBox12Knockout">
      <Description>The "first" W2 that has a Box 12 code that knocks you out</Description>
      <Derived>
        <IndexOf>
          <Collection>
            <Dependency path="/formW2sWithBox12KnockoutCodes" />
          </Collection>
          <Index>
            <Int>0</Int>
          </Index>
        </IndexOf>
      </Derived>
    </Fact>

    <Fact path="/knockoutForBox12Value">
      <Name>Has a Box 12 Value We Knockout</Name>
      <Description>Has the filer entered a W2 with any of the Box 12 codes we knockout</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/hasBox12KnockoutCode" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasBox12HsaWCode">
      <Name>Filer has input code W HSA contribution in Box 12 for this W2</Name>
      <Description>Whether filer has code W HSA contribution in Box 12 for this W2</Description>
      <Derived>
        <IsComplete>
          <Dependency path="../employerHsaContributions" />
        </IsComplete>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasBox12HsaContributionsAndDependent">
      <Name>W2 belongs to filer which can be claimed as dependent and has HSA contributions in Box
        12</Name>
      <Description>The W2 belongs to filer which can be claimed ad dependent and code W is entered
        in Box 12</Description>
      <Derived>
        <All>
          <Dependency module="filers" path="../filer/canBeClaimed" />
          <Dependency path="../hasBox12HsaWCode" />
          <GreaterThan>
            <Left>
              <Dependency path="../employerHsaContributionsRounded" />
            </Left>
            <Right>
              <Dollar>0</Dollar>
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/knockoutForBox12Dependency">
      <Name>Knockout when Box 12 has contributions for code W but TP is dependent</Name>
      <Description>Filer has entered W2 contributions for HSA in Box 12 and has dependency status</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/hasBox12HsaContributionsAndDependent" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>
    <!--
        Box 14's facts and knockout facts below
       -->
    <Fact path="/formW2s/*/hasInputBox14Codes">
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="filers" path="/livedInNy" />
            </When>
            <Then>
              <Any>
                <IsComplete>
                  <Dependency path="../hasOtherBox14Code" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../414_H" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../414_H_CU" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../414H" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../414HCU" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../414HSUB" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../ERS" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../ERSNYSRE" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../ERSRETCO" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../IRC125S" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../MEDICARE_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../NYRET" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../NYSERS" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../NYSRETCO" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../PUBRET" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RET" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RETDEF" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RETMT" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RETSH" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RETSM" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RETSUM" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RRTA_COMPENSATION" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER_1_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER_2_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER3RET" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER4" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER4RET" />
                </IsComplete>
              </Any>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency module="filers" path="/livedInMd" />
            </When>
            <Then>
              <Any>
                <IsComplete>
                  <Dependency path="../hasOtherBox14Code" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../MEDICARE_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RRTA_COMPENSATION" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER_1_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER_2_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../BOX14_MD_STPICKUP" />
                </IsComplete>
              </Any>
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency module="filers" path="/livedInNj" />
            </When>
            <Then>
              <Any>
                <IsComplete>
                  <Dependency path="../hasOtherBox14Code" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../BOX14_NJ_FLI" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../MEDICARE_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../RRTA_COMPENSATION" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER_1_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../TIER_2_TAX" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../BOX14_NJ_UIHCWD" />
                </IsComplete>
                <IsComplete>
                  <Dependency path="../BOX14_NJ_UIWFSWF" />
                </IsComplete>
              </Any>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <False />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableHasBox14Codes">
      <Name>W2 has Box 14 Codes</Name>
      <Description>Whether this W2 has any codes or amounts in box 14</Description>

      <Writable>
        <Boolean />
      </Writable>

      <Placeholder>
        <!-- We only want to set a placeholder if the user has already seen the last screen -->
        <Switch>
          <Case>
            <When>
              <Dependency path="../hasSeenLastAvailableScreen" />
            </When>
            <Then>
              <Dependency path="../hasInputBox14Codes" />
            </Then>
          </Case>
        </Switch>
      </Placeholder>
    </Fact>

    <Fact path="/formW2s/*/hasBox14Codes">
      <Name>Filer has input Box 14 Codes for this W2</Name>
      <Description>Whether filer has input any box 14 codes for this W2</Description>

      <Derived>
        <Any>
          <Dependency path="../hasInputBox14Codes" />
          <Dependency path="../writableHasBox14Codes" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/mdResidentHasOtherBox14Codes">
      <Name>MD resident has other Box 14 codes</Name>
      <Description>Whether a Maryland resident has indicated they have a Box 14 code
        on their W-2 that is not one of the
        existing options; used to determine whether
        to ask about union dues.</Description>

      <Derived>
        <All>
          <Dependency module="filers" path="/livedInMd" />
          <Dependency path="../writableHasBox14Codes" />
          <IsComplete>
            <Dependency path="../hasOtherBox14Code" />
          </IsComplete>
          <Dependency path="../hasOtherBox14Code" />
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/paidUnionDues">
      <Name>Paid union dues</Name>
      <Description>Whether Box 14 has codes related to dues paid for union membership;
        currently only asked of MD
        residents</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/writableUnionDuesAmount">
      <Name>Amount of union dues paid</Name>
      <Description>The amount from Box 14 of codes related to dues paid for union membership;
        currently only asked of MD
        residents</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/unionDuesAmount">
      <Name>Amount of union dues paid</Name>
      <Description>The amount from Box 14 of codes related to dues paid for union membership;
        currently only asked of MD
        residents. This fact will be incomplete if the taxpayer changes
        prior answers, such as if they say they didn't
        pay union dues or they didn't live in MD.</Description>
      <Export stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Dependency path="../mdResidentHasOtherBox14Codes" />
                <Dependency path="../paidUnionDues" />
              </All>
            </When>
            <Then>
              <Round>
                <Dependency path="../writableUnionDuesAmount" />
              </Round>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableBox14Code">
      <Name>Box 14 Code</Name>
      <Description>An enum used to power a fact select for Box 14, used by NY filers</Description>
      <Writable>
        <Enum optionsPath="/box14NYCodeOptions" />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/writableBox14CodeMd">
      <Name>Box 14 Code</Name>
      <Description>An enum used to power a fact select for Box 14, used by MD filers</Description>
      <Writable>
        <Enum optionsPath="/box14MDCodeOptions" />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/writableBox14CodeNj">
      <Name>Box 14 Code</Name>
      <Description>An enum used to power a fact select for Box 14, used by NJ filers</Description>
      <Writable>
        <Enum optionsPath="/box14NJCodeOptions" />
      </Writable>
    </Fact>

    <!-- the best way to know if a box 14 value was chosen is to check if there is a value set for
    it on the w2, not by
    checking writableBox14Code -->
    <Fact path="/formW2s/*/knockoutBox14NYRRTACode">
      <Name>Knockout Box 14 NY RRTA Code</Name>
      <Description>Which of the box 14 codes that can knock a filer for NY RRTA out have a positive
        value. Used to give
        the filer information which code knocked them out (and stays incomplete if the filer doesn't
        have a code that
        knocks them out)</Description>
      <Derived>
        <Switch>

          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/box14NYCodeOptions">ADDITIONAL_MEDICARE_TAX</Enum>
            </Then>
          </Case>


          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../MEDICARE_TAX" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../MEDICARE_TAX" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/box14NYCodeOptions">MEDICARE_TAX</Enum>
            </Then>
          </Case>


          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../RRTA_COMPENSATION" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../RRTA_COMPENSATION" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/box14NYCodeOptions">RRTA_COMPENSATION</Enum>
            </Then>
          </Case>


          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../TIER_1_TAX" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../TIER_1_TAX" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/box14NYCodeOptions">TIER_1_TAX</Enum>
            </Then>
          </Case>


          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../TIER_2_TAX" />
                </IsComplete>
                <GreaterThan>
                  <Left>
                    <Dependency path="../TIER_2_TAX" />
                  </Left>
                  <Right>
                    <Dollar>0</Dollar>
                  </Right>
                </GreaterThan>
              </All>
            </When>
            <Then>
              <Enum optionsPath="/box14NYCodeOptions">TIER_2_TAX</Enum>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasBox14NYRRTAKnockoutCode">
      <Name>Box 14 NY RRTA Knockout</Name>
      <Description>Do any of the codes for box 14 NY RRTA that can knock a tax payer out have a
        positive value</Description>
      <Derived>
        <All>
          <!-- Handle an edit where the user says they don't have box 14 codes-->
          <Dependency path="../hasBox14Codes" />
          <IsComplete>
            <Dependency path="../knockoutBox14NYRRTACode" />
          </IsComplete>
        </All>
      </Derived>
    </Fact>

    <Fact path="/hasABox14NYRRTAValueWeKnockout">
      <Name>Has a Box 14 NY RRTA Value We Knockout</Name>
      <Description>Has the filer entered a W2 with any of the Box 14 codes we knockout</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/hasBox14NYRRTAKnockoutCode" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2sWithBox14NYRRTAKnockoutCode">
      <Description>A collection of W2s that have a Box 14 code related to yonkers that we knock out</Description>
      <Derived>
        <Filter path="/formW2s">
          <Dependency path="hasBox14NYRRTAKnockoutCode" />
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/formW2WithBox14NYRRTAKnockout">
      <Description>The "first" W2 that has a Box 14 Yonkers Knockout Code</Description>
      <Derived>
        <IndexOf>
          <Collection>
            <Dependency path="/formW2sWithBox14NYRRTAKnockoutCode" />
          </Collection>
          <Index>
            <Int>0</Int>
          </Index>
        </IndexOf>
      </Derived>

    </Fact>

    <Fact path="/formW2s/*/hasOtherBox14Code">
      <Name>Whether the form W2 has an unsupported box 14 code</Name>
      <Description>Whether the form W2 has an unsupported box 14 code</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>
    <Fact path="/formW2s/*/414_H">
      <Name>Box 14 code 414_H</Name>
      <Description>Box 14 code 414_H, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/414_HNeeded">
      <Name>Box 14 code 414_H needed</Name>
      <Description>Box 14 code 414_H, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../414_H" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414_HRounded">
      <Name>Box 14 code 414_H</Name>
      <Description>Box 14 code 414_H, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../414_H" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414_H_CU">
      <Name>Box 14 code 414_H_CU</Name>
      <Description>Box 14 code 414_H_CU, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/414_H_CUNeeded">
      <Name>Box 14 code 414_H_CU needed</Name>
      <Description>Box 14 code 414_H_CU, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../414_H_CU" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414_H_CURounded">
      <Name>Box 14 code 414_H_CU</Name>
      <Description>Box 14 code 414_H_CU, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../414_H_CU" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414H">
      <Name>Box 14 code 414H</Name>
      <Description>Box 14 code 414H, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/414HNeeded">
      <Name>Box 14 code 414H needed</Name>
      <Description>Box 14 code 414H, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../414H" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414HRounded">
      <Name>Box 14 code 414H</Name>
      <Description>Box 14 code 414H, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../414H" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414HCU">
      <Name>Box 14 code 414HCU</Name>
      <Description>Box 14 code 414HCU, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/414HCUNeeded">
      <Name>Box 14 code 414HCU needed</Name>
      <Description>Box 14 code 414HCU, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../414HCU" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414HCURounded">
      <Name>Box 14 code 414HCU</Name>
      <Description>Box 14 code 414HCU, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../414HCU" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414HSUB">
      <Name>Box 14 code 414HSUB</Name>
      <Description>Box 14 code 414HSUB, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/414HSUBNeeded">
      <Name>Box 14 code 414HSUB needed</Name>
      <Description>Box 14 code 414HSUB, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../414HSUB" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/414HSUBRounded">
      <Name>Box 14 code 414HSUB</Name>
      <Description>Box 14 code 414HSUB, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../414HSUB" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ADDITIONAL_MEDICARE_TAX">
      <Name>Box 14 code ADDITIONAL_MEDICARE_TAX</Name>
      <Description>Box 14 code ADDITIONAL_MEDICARE_TAX, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/ADDITIONAL_MEDICARE_TAXNeeded">
      <Name>Box 14 code ADDITIONAL_MEDICARE_TAX needed</Name>
      <Description>Box 14 code ADDITIONAL_MEDICARE_TAX, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ADDITIONAL_MEDICARE_TAXRounded">
      <Name>Box 14 code ADDITIONAL_MEDICARE_TAX</Name>
      <Description>Box 14 code ADDITIONAL_MEDICARE_TAX, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../ADDITIONAL_MEDICARE_TAX" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ERS">
      <Name>Box 14 code ERS</Name>
      <Description>Box 14 code ERS, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/ERSNeeded">
      <Name>Box 14 code ERS needed</Name>
      <Description>Box 14 code ERS, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../ERS" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ERSRounded">
      <Name>Box 14 code ERS</Name>
      <Description>Box 14 code ERS, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../ERS" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ERSNYSRE">
      <Name>Box 14 code ERSNYSRE</Name>
      <Description>Box 14 code ERSNYSRE, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/ERSNYSRENeeded">
      <Name>Box 14 code ERSNYSRE needed</Name>
      <Description>Box 14 code ERSNYSRE, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../ERSNYSRE" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ERSNYSRERounded">
      <Name>Box 14 code ERSNYSRE</Name>
      <Description>Box 14 code ERSNYSRE, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../ERSNYSRE" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ERSRETCO">
      <Name>Box 14 code ERSRETCO</Name>
      <Description>Box 14 code ERSRETCO, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/ERSRETCONeeded">
      <Name>Box 14 code ERSRETCO needed</Name>
      <Description>Box 14 code ERSRETCO, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../ERSRETCO" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/ERSRETCORounded">
      <Name>Box 14 code ERSRETCO</Name>
      <Description>Box 14 code ERSRETCO, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../ERSRETCO" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/IRC125S">
      <Name>Box 14 code IRC125S</Name>
      <Description>Box 14 code IRC125S, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/IRC125SNeeded">
      <Name>Box 14 code IRC125S needed</Name>
      <Description>Box 14 code IRC125S, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../IRC125S" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/IRC125SRounded">
      <Name>Box 14 code IRC125S</Name>
      <Description>Box 14 code IRC125S, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../IRC125S" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/MEDICARE_TAX">
      <Name>Box 14 code MEDICARE_TAX</Name>
      <Description>Box 14 code MEDICARE_TAX, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/MEDICARE_TAXNeeded">
      <Name>Box 14 code MEDICARE_TAX needed</Name>
      <Description>Box 14 code MEDICARE_TAX, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../MEDICARE_TAX" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/MEDICARE_TAXRounded">
      <Name>Box 14 code MEDICARE_TAX</Name>
      <Description>Box 14 code MEDICARE_TAX, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../MEDICARE_TAX" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/NYRET">
      <Name>Box 14 code NYRET</Name>
      <Description>Box 14 code NYRET, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/NYRETNeeded">
      <Name>Box 14 code NYRET needed</Name>
      <Description>Box 14 code NYRET, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../NYRET" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/NYRETRounded">
      <Name>Box 14 code NYRET</Name>
      <Description>Box 14 code NYRET, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../NYRET" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/NYSERS">
      <Name>Box 14 code NYSERS</Name>
      <Description>Box 14 code NYSERS, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/NYSERSNeeded">
      <Name>Box 14 code NYSERS needed</Name>
      <Description>Box 14 code NYSERS, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../NYSERS" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/NYSERSRounded">
      <Name>Box 14 code NYSERS</Name>
      <Description>Box 14 code NYSERS, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../NYSERS" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/NYSRETCO">
      <Name>Box 14 code NYSRETCO</Name>
      <Description>Box 14 code NYSRETCO, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/NYSRETCONeeded">
      <Name>Box 14 code NYSRETCO needed</Name>
      <Description>Box 14 code NYSRETCO, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../NYSRETCO" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/NYSRETCORounded">
      <Name>Box 14 code NYSRETCO</Name>
      <Description>Box 14 code NYSRETCO, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../NYSRETCO" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/PUBRET">
      <Name>Box 14 code PUBRET</Name>
      <Description>Box 14 code PUBRET, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/PUBRETNeeded">
      <Name>Box 14 code PUBRET needed</Name>
      <Description>Box 14 code PUBRET, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../PUBRET" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/PUBRETRounded">
      <Name>Box 14 code PUBRET</Name>
      <Description>Box 14 code PUBRET, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../PUBRET" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RET">
      <Name>Box 14 code RET</Name>
      <Description>Box 14 code RET, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RETNeeded">
      <Name>Box 14 code RET needed</Name>
      <Description>Box 14 code RET, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RET" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETRounded">
      <Name>Box 14 code RET</Name>
      <Description>Box 14 code RET, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RET" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETDEF">
      <Name>Box 14 code RETDEF</Name>
      <Description>Box 14 code RETDEF, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RETDEFNeeded">
      <Name>Box 14 code RETDEF needed</Name>
      <Description>Box 14 code RETDEF, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RETDEF" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETDEFRounded">
      <Name>Box 14 code RETDEF</Name>
      <Description>Box 14 code RETDEF, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RETDEF" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETMT">
      <Name>Box 14 code RETMT</Name>
      <Description>Box 14 code RETMT, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RETMTNeeded">
      <Name>Box 14 code RETMT needed</Name>
      <Description>Box 14 code RETMT, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RETMT" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETMTRounded">
      <Name>Box 14 code RETMT</Name>
      <Description>Box 14 code RETMT, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RETMT" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETSH">
      <Name>Box 14 code RETSH</Name>
      <Description>Box 14 code RETSH, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RETSHNeeded">
      <Name>Box 14 code RETSH needed</Name>
      <Description>Box 14 code RETSH, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RETSH" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETSHRounded">
      <Name>Box 14 code RETSH</Name>
      <Description>Box 14 code RETSH, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RETSH" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETSM">
      <Name>Box 14 code RETSM</Name>
      <Description>Box 14 code RETSM, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RETSMNeeded">
      <Name>Box 14 code RETSM needed</Name>
      <Description>Box 14 code RETSM, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RETSM" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETSMRounded">
      <Name>Box 14 code RETSM</Name>
      <Description>Box 14 code RETSM, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RETSM" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETSUM">
      <Name>Box 14 code RETSUM</Name>
      <Description>Box 14 code RETSUM, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RETSUMNeeded">
      <Name>Box 14 code RETSUM needed</Name>
      <Description>Box 14 code RETSUM, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RETSUM" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RETSUMRounded">
      <Name>Box 14 code RETSUM</Name>
      <Description>Box 14 code RETSUM, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RETSUM" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RRTA_COMPENSATION">
      <Name>Box 14 code RRTA_COMPENSATION</Name>
      <Description>Box 14 code RRTA_COMPENSATION, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/RRTA_COMPENSATIONNeeded">
      <Name>Box 14 code RRTA_COMPENSATION needed</Name>
      <Description>Box 14 code RRTA_COMPENSATION, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../RRTA_COMPENSATION" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/RRTA_COMPENSATIONRounded">
      <Name>Box 14 code RRTA_COMPENSATION</Name>
      <Description>Box 14 code RRTA_COMPENSATION, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../RRTA_COMPENSATION" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER_1_TAX">
      <Name>Box 14 code TIER_1_TAX</Name>
      <Description>Box 14 code TIER_1_TAX, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/TIER_1_TAXNeeded">
      <Name>Box 14 code TIER_1_TAX needed</Name>
      <Description>Box 14 code TIER_1_TAX, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../TIER_1_TAX" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER_1_TAXRounded">
      <Name>Box 14 code TIER_1_TAX</Name>
      <Description>Box 14 code TIER_1_TAX, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../TIER_1_TAX" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER_2_TAX">
      <Name>Box 14 code TIER_2_TAX</Name>
      <Description>Box 14 code TIER_2_TAX, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/TIER_2_TAXNeeded">
      <Name>Box 14 code TIER_2_TAX needed</Name>
      <Description>Box 14 code TIER_2_TAX, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../TIER_2_TAX" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER_2_TAXRounded">
      <Name>Box 14 code TIER_2_TAX</Name>
      <Description>Box 14 code TIER_2_TAX, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../TIER_2_TAX" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER3RET">
      <Name>Box 14 code TIER3RET</Name>
      <Description>Box 14 code TIER3RET, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/TIER3RETNeeded">
      <Name>Box 14 code TIER3RET needed</Name>
      <Description>Box 14 code TIER3RET, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../TIER3RET" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER3RETRounded">
      <Name>Box 14 code TIER3RET</Name>
      <Description>Box 14 code TIER3RET, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../TIER3RET" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER4">
      <Name>Box 14 code TIER4</Name>
      <Description>Box 14 code TIER4, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/TIER4Needed">
      <Name>Box 14 code TIER4 needed</Name>
      <Description>Box 14 code TIER4, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../TIER4" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER4Rounded">
      <Name>Box 14 code TIER4</Name>
      <Description>Box 14 code TIER4, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../TIER4" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER4RET">
      <Name>Box 14 code TIER4RET</Name>
      <Description>Box 14 code TIER4RET, used by New York State or City</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/TIER4RETNeeded">
      <Name>Box 14 code TIER4RET needed</Name>
      <Description>Box 14 code TIER4RET, used by New York State or City</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../TIER4RET" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/TIER4RETRounded">
      <Name>Box 14 code TIER4RET</Name>
      <Description>Box 14 code TIER4RET, used by New York State or City</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../TIER4RET" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableCombatPay">
      <Name>(Writable) Nontaxable combat pay</Name>
      <Description>The user transcribes this value as seen on box 12, code Q of a W-2. Represents
        combat pay. If left
        empty, the W-2 XML that we send to MeF will not have a corresponding EmployersUseCd element.
        Derived
        calculations
        will treat an empty field as 0. Note 1/18/2024: this use to be used directly
        before the zero export
        change.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/combatPayNeeded">
      <Name>(Writable) Nontaxable combat pay needed</Name>
      <Description>Combat pay needed</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../writableCombatPay" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/combatPay">
      <Name>Nontaxable combat pay</Name>
      <Description>Box 12, code Q. Takes what the user said, but if they have not entered combat
        pay, assumes zero.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableCombatPay" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableCombatPay" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/archerMsaContributions">
      <Name>Employer contributions to an Archer MSA</Name>
      <Description>Box 12, code R.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/archerMsaContributionsNeeded">
      <Name>Employer contributions to an Archer MSA</Name>
      <Description>Box 12, code R.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../archerMsaContributions" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/archerMsaContributionsRounded">
      <Name>Employer contributions to an Archer MSA</Name>
      <Description>Box 12, code R.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../archerMsaContributions" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/simpleContributions">
      <Name>Employee salary reduction contributions under a section 408(p) SIMPLE plan</Name>
      <Description>Box 12, code S.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/simpleContributionsNeeded">
      <Name>Employee salary reduction contributions under a section 408(p) SIMPLE plan</Name>
      <Description>Box 12, code S.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../simpleContributions" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/simpleContributionsRounded">
      <Name>Employee salary reduction contributions under a section 408(p) SIMPLE plan</Name>
      <Description>Box 12, code S.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../simpleContributions" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/adoptionBenefits">
      <Name>Adoption benefits</Name>
      <Description>Box 12, code T.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/adoptionBenefitsNeeded">
      <Name>Adoption benefits</Name>
      <Description>Box 12, code T.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../adoptionBenefits" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/adoptionBenefitsRounded">
      <Name>Adoption benefits</Name>
      <Description>Box 12, code T.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../adoptionBenefits" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nsoIncome">
      <Name>Income from exercise of nonstatutory stock option(s)</Name>
      <Description>Box 12, code V.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/nsoIncomeNeeded">
      <Name>Income from exercise of nonstatutory stock option(s)</Name>
      <Description>Box 12, code V.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../nsoIncome" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nsoIncomeRounded">
      <Name>Income from exercise of nonstatutory stock option(s)</Name>
      <Description>Box 12, code V.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../nsoIncome" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/employerHsaContributions">
      <Name>Employer contributions (including employee contributions through a cafeteria plan) to an
        employee's health
        savings account (HSA)</Name>
      <Description>Box 12, code W.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/employerHsaContributionsNeeded">
      <Name>Employer contributions (including employee contributions through a cafeteria plan) to an
        employee's health
        savings account (HSA)</Name>
      <Description>Box 12, code W.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../employerHsaContributionsRounded" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/employerHsaContributionsRounded">
      <Name>Employer contributions (including employee contributions through a cafeteria plan) to an
        employee's health
        savings account (HSA)</Name>
      <Description>Box 12, code W.</Description>
      <Export mef="true" />
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../employerHsaContributions" />
              </IsComplete>
            </When>
            <Then>
              <Round>
                <Dependency path="../employerHsaContributions" />
              </Round>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/409aDeferrals">
      <Name>Deferrals under a section 409A nonqualified deferred compensation plan</Name>
      <Description>Box 12, code Y.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/409aDeferralsNeeded">
      <Name>Deferrals under a section 409A nonqualified deferred compensation plan</Name>
      <Description>Box 12, code Y.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../409aDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/409aDeferralsRounded">
      <Name>Deferrals under a section 409A nonqualified deferred compensation plan</Name>
      <Description>Box 12, code Y.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../409aDeferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nqdcDeferrals">
      <Name>Income under a nonqualified deferred compensation plan that fails to satisfy section
        409A</Name>
      <Description>Box 12, code Z.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/nqdcDeferralsNeeded">
      <Name>Income under a nonqualified deferred compensation plan that fails to satisfy section
        409A</Name>
      <Description>Box 12, code Z.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../nqdcDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nqdcDeferralsRounded">
      <Name>Income under a nonqualified deferred compensation plan that fails to satisfy section
        409A</Name>
      <Description>Box 12, code Z.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../nqdcDeferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/roth401kContributions">
      <Name>Designated Roth contributions under a section 401(k) plan</Name>
      <Description>Box 12, code AA.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/roth401kContributionsNeeded">
      <Name>Designated Roth contributions under a section 401(k) plan</Name>
      <Description>Box 12, code AA.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../roth401kContributions" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/roth401kContributionsRounded">
      <Name>Designated Roth contributions under a section 401(k) plan</Name>
      <Description>Box 12, code AA.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../roth401kContributions" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/roth403bContributions">
      <Name>Designated Roth contributions under a section 403(b) plan</Name>
      <Description>Box 12, code BB.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/roth403bContributionsNeeded">
      <Name>Designated Roth contributions under a section 403(b) plan</Name>
      <Description>Box 12, code BB.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../roth403bContributions" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/roth403bContributionsRounded">
      <Name>Designated Roth contributions under a section 403(b) plan</Name>
      <Description>Box 12, code BB.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../roth403bContributions" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/healthCoverageCost">
      <Name>Cost of employer-sponsored health coverage</Name>
      <Description>Box 12, code DD.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/healthCoverageCostNeeded">
      <Name>Cost of employer-sponsored health coverage</Name>
      <Description>Box 12, code DD.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../healthCoverageCost" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/healthCoverageCostRounded">
      <Name>Cost of employer-sponsored health coverage</Name>
      <Description>Box 12, code DD.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../healthCoverageCost" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/roth457bContributions">
      <Name>Designated Roth contributions under a governmental section 457(b) plan</Name>
      <Description>Box 12, code EE.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/roth457bContributionsNeeded">
      <Name>Designated Roth contributions under a governmental section 457(b) plan</Name>
      <Description>Box 12, code EE.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../roth457bContributions" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/roth457bContributionsRounded">
      <Name>Designated Roth contributions under a governmental section 457(b) plan</Name>
      <Description>Box 12, code EE.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../roth457bContributions" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/qsehraBenefits">
      <Name>Permitted benefits under a qualified small employer health reimbursement arrangement</Name>
      <Description>Box 12, code FF.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/hasQsehra">
      <Description>Whether any of the W2s have QSEHRA benefits</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <IsComplete>
          <Find path="/formW2s">
            <Dependency path="qsehraBenefitsNeeded" />
          </Find>
        </IsComplete>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/qsehraBenefitsNeeded">
      <Name>Permitted benefits under a qualified small employer health reimbursement arrangement</Name>
      <Description>Box 12, code FF.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../qsehraBenefits" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/qsehraBenefitsRounded">
      <Name>Permitted benefits under a qualified small employer health reimbursement arrangement</Name>
      <Description>Box 12, code FF.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../qsehraBenefits" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/83iIncome">
      <Name>Income from qualified equity grants under section 83(i)</Name>
      <Description>Box 12, code GG.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/83iIncomeNeeded">
      <Name>Income from qualified equity grants under section 83(i)</Name>
      <Description>Box 12, code GG.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../83iIncome" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/83iIncomeRounded">
      <Name>Income from qualified equity grants under section 83(i)</Name>
      <Description>Box 12, code GG.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../83iIncome" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/83iDeferrals">
      <Name>Aggregate deferrals under section 83(i) elections as of the close of the calendar year</Name>
      <Description>Box 12, code HH.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/83iDeferralsNeeded">
      <Name>Aggregate deferrals under section 83(i) elections as of the close of the calendar year</Name>
      <Description>Box 12, code HH.</Description>
      <Export mef="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../83iDeferrals" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/83iDeferralsRounded">
      <Name>Aggregate deferrals under section 83(i) elections as of the close of the calendar year</Name>
      <Description>Box 12, code HH.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Dependency path="../83iDeferrals" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nonTaxableMedicaidWaiverPayments">
      <Description>Nontaxable Medicaid waiver payments reported on Form(s) W-2. If you received
        nontaxable Medicaid
        waiver payments, those amounts should now be reported to you on Form(s) W-2 in box 12, Code
        II.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/nonTaxableMedicaidWaiverPaymentsNeeded">
      <Description>Nontaxable Medicaid waiver payments reported on Form(s) W-2. If you received
        nontaxable Medicaid
        waiver payments, those amounts should now be reported to you on Form(s) W-2 in box 12, Code
        II.</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../nonTaxableMedicaidWaiverPayments" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nonTaxableMedicaidWaiverPaymentsRounded">
      <Description>Nontaxable Medicaid waiver payments reported on Form(s) W-2. If you received
        nontaxable Medicaid
        waiver payments, those amounts should now be reported to you on Form(s) W-2 in box 12, Code
        II.</Description>

      <Derived>
        <Round>
          <Dependency path="../nonTaxableMedicaidWaiverPayments" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/statutoryEmployee">
      <Name>Statutory employee</Name>
      <Description>Whether statutory employee is checked in box 13.</Description>
      <Export mef="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/retirementPlan">
      <Name>Retirement plan</Name>
      <Description>Whether retirement plan is checked in box 13.</Description>
      <Export mef="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/thirdPartySickPay">
      <Name>Third-party sick pay</Name>
      <Description>Whether third-party sick pay is checked in box 13.</Description>
      <Export mef="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/writableState">
      <Name>State</Name>
      <Description>Part of form W-2 box 15: The state of residence.</Description>

      <Writable>
        <Enum optionsPath="/incomeFormStateOptions" />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/state">
      <Name>State</Name>
      <Description>Alias for writableState to avoid breaking the backend with our convention for
        optional fields.</Description>

      <Derived>
        <Dependency path="../writableState" />
      </Derived>

    </Fact>


    <Fact path="/flowKnockoutBox15IncomeFromDifferentState">
      <Name>Flow Knockout Income from Unsupported State</Name>
      <Description>Used to control a knockout for if the filer recieved income from an unsupported
        state.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/hasKnockoutBox15IncomeFromDifferentState" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasKnockoutBox15IncomeFromDifferentState">
      <Name>Has Knockout recieved Income from a Different State</Name>
      <Description>Checks to see if their income is from a different state.</Description>

      <Derived>
        <All>
          <IsComplete>
            <Dependency path="../writableState" />
          </IsComplete>
          <Equal>
            <Left>
              <Dependency path="../writableState" />
            </Left>
            <Right>
              <Enum optionsPath="/incomeFormStateOptions">differentState</Enum>
            </Right>
          </Equal>
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/pdfStateCode">
      <Name>State Code (pdf)</Name>
      <Description>The state code used to populate the IRS W2 PDF field corresponding to form W-2
        box 15.</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Equal>
                  <Left>
                    <Dependency path="../writableState" />
                  </Left>
                  <Right>
                    <Enum optionsPath="/incomeFormStateOptions">sameState</Enum>
                  </Right>
                </Equal>
                <NotEqual>
                  <Left>
                    <Dependency module="filers" path="/filerResidenceAndIncomeState" />
                  </Left>
                  <Right>
                    <Enum optionsPath="/scopedStateOptions">moreThanOne</Enum>
                  </Right>
                </NotEqual>
                <NotEqual>
                  <Left>
                    <Dependency module="filers" path="/filerResidenceAndIncomeState" />
                  </Left>
                  <Right>
                    <Enum optionsPath="/scopedStateOptions">noneOfThese</Enum>
                  </Right>
                </NotEqual>
              </All>
            </When>
            <Then>
              <Dependency module="filers" path="/filerResidenceAndIncomeState" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/xmlStateCd">
      <Name>State Code (xml)</Name>
      <Description>The state code used to populate the IRS W2 XML element corresponding to form W-2
        box 15. This fact is
        used to handle mapping the values used by the DF client into what the MeF system and DF
        submit application
        expect.</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../writableState" />
                </IsComplete>
                <Equal>
                  <Left>
                    <Dependency module="filers" path="/filerResidenceAndIncomeState" />
                  </Left>
                  <Right>
                    <Enum optionsPath="/scopedStateOptions">moreThanOne</Enum>
                  </Right>
                </Equal>
              </All>
            </When>
            <Then>
              <String>MULTIPLE</String>
            </Then>
          </Case>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../writableState" />
                </IsComplete>
                <Equal>
                  <Left>
                    <Dependency module="filers" path="/filerResidenceAndIncomeState" />
                  </Left>
                  <Right>
                    <Enum optionsPath="/scopedStateOptions">noneOfThese</Enum>
                  </Right>
                </Equal>
              </All>
            </When>
            <Then>
              <String>NONE</String>
            </Then>
          </Case>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableState" />
              </IsComplete>
            </When>
            <Then>
              <ToUpper>
                <AsString>
                  <Dependency module="filers" path="/filerResidenceAndIncomeState" />
                </AsString>
              </ToUpper>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableStateEmployerId">
      <Name>Employer's state ID number</Name>
      <Description>Part of form W-2 box 15: The employer's state ID number. This is the writable
        optional fact. Can be
        left incomplete, and will likely be left incomplete by states that do not collect personal
        income tax.</Description>

      <Writable>
        <String />
        <Limit type="Match">
          <String><![CDATA[([!-~]\s?)*[!-~]]]></String>
        </Limit>
        <Limit type="MaxLength">
          <Int>16</Int>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/stateEmployerId">
      <Name>Employer's state ID number</Name>
      <Description>Part of form W-2 box 15: The employer's state ID number. Alias for
        writableStateEmployerId.
      </Description>
      <Export mef="true" />


      <Derived>
        <StripChars>
          <Input>
            <Dependency path="../writableStateEmployerId" />
          </Input>
          <Allow>
            <Dependency module="mefTypes" path="/mefStateEmployerIdType" />
          </Allow>
        </StripChars>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasStateWagesWithoutStateCode">
      <Description>Whether the form lists state wages but is missing the associated state code. Corresponds with a
        validation alert since the TP should always have a state code when they have state information</Description>
      <Derived>
        <All>
          <GreaterThan>
            <Left>
              <Dependency path="../stateWages" />
            </Left>
            <Right>
              <Dollar>0</Dollar>
            </Right>
          </GreaterThan>
          <Not>
            <IsComplete>
              <Dependency path="../writableState" />
            </IsComplete>
          </Not>
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableStateWages">
      <Name>State wages, tips, etc.</Name>
      <Description>Form W-2 box 16: Wages, tips, and other compensation allocated to the state. This
        is the writable
        optional fact. Can be left incomplete. Please use the derived fact in downstream
        calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/stateWages">
      <Name>State wages, tips, etc.</Name>
      <Description>Form W-2 box 16: Wages, tips, and other compensation allocated to the state.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableStateWages" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableStateWages" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/missingStateIncome">
      <Name>Whether the W-2 is missing state income (box 16)</Name>
      <Description>Form W-2 box 16: Wages, tips, and other compensation allocated to the state.</Description>

      <Derived>
        <All>
          <Not>
            <Dependency path="/hasNoStateIncomeTax" module="constants" />
          </Not>
          <Equal>
            <Left>
              <Dependency path="../stateWages" />
            </Left>
            <Right>
              <Dollar>0</Dollar>
            </Right>
          </Equal>
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableStateWithholding">
      <Name>State income tax</Name>
      <Description>Form W-2 box 17: State income tax withheld.

        This is the writable optional fact. Can be left
        incomplete. Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/stateWithholding">
      <Name>State income tax</Name>
      <Description>Form W-2 box 17: State income tax withheld.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableStateWithholding" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableStateWithholding" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableLocalWages">
      <Name>Local wages, tips, etc.</Name>
      <Description>Form W-2 box 18: Wages, tips, and other compensation allocated to the locality.
        This is the writable
        optional fact. Can be left incomplete. Please use the derived fact in downstream
        calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/localWages">
      <Name>Local wages, tips, etc.</Name>
      <Description>Form W-2 box 18: Wages, tips, and other compensation allocated to the locality.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableLocalWages" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableLocalWages" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableLocalWithholding">
      <Name>Local income tax</Name>
      <Description>Form W-2 box 19: Local income tax withheld.

        This is the writable optional fact. Can be left
        incomplete. Please use the derived fact in downstream calculations.</Description>
      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/localWithholding">
      <Name>Local income tax</Name>
      <Description>Form W-2 box 19: Local income tax withheld.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <IsComplete>
                  <Dependency path="../writableLocalWithholding" />
                </IsComplete>
              </When>
              <Then>
                <Dependency path="../writableLocalWithholding" />
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/writableLocality">
      <Name>Locality name</Name>
      <Description>Form W-2 box 20: Locality name.

        This is the writable optional fact. Can be left incomplete. Please use
        the derived fact in downstream calculations.</Description>
      <Writable>
        <String />
        <Limit type="Match">
          <String><![CDATA[([!-~]\s?)*[!-~]]]></String>
        </Limit>
        <Limit type="MaxLength">
          <Int>20</Int>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/locality">
      <Name>Locality name</Name>
      <Description>Form W-2 box 20: Locality name.</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableLocality" />
              </IsComplete>
            </When>
            <Then>
              <Trim>
                <StripChars>
                  <Input>
                    <Dependency path="../writableLocality" />
                  </Input>
                  <Allow>
                    <Dependency module="mefTypes" path="/mefLocalityNmType" />
                  </Allow>
                </StripChars>
              </Trim>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <String></String>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <!-- Yonkers codes -->
    <Fact path="/formW2s/*/box20HasYonkers">
      <Name>Box 20 Yonkers boolean</Name>
      <Description>Does this W2 have Yonkers box 20 codes?</Description>

      <Derived>
        <Any>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>YONKERS</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>YK</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>YON</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>YNK</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>CITYOFYK</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>CTYOFYKR</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>CITYOF YK</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>CITY OFYK</String>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Trim>
                <ToUpper>
                  <Dependency path="../locality" />
                </ToUpper>
              </Trim>
            </Left>
            <Right>
              <String>CTY OF YK</String>
            </Right>
          </Equal>
        </Any>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/paidYonkersTaxes">
      <Name>Paid taxes in Yonkers</Name>
      <Description>Does the W2 show Yonkers taxes?</Description>
      <Derived>
        <All>
          <Dependency module="filers" path="/livedInNy"></Dependency>
          <GreaterThan>
            <Left>
              <Count>
                <Dependency path="/formW2s/*/box20HasYonkers" />
              </Count>
            </Left>
            <Right>
              <Int>0</Int>
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/partYearYonkersResident">
      <Name>Lived outside of Yonkers during TY</Name>
      <Description>Whether the taxpayer lived outside of Yonkers during the tax year, and is a
        part-year Yonkers
        resident.</Description>
      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/knockoutYonkersPartYear">
      <Name>Knockout for part-year Yonkers residents</Name>
      <Description>The taxpayer paid taxes in Yonkers and said that they are a part-year
        resident of Yonkers</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <All>
          <GreaterThan>
            <Left>
              <Count>
                <Dependency path="/formW2s/*/paidYonkersTaxes" />
              </Count>
            </Left>
            <Right>
              <Int>0</Int>
            </Right>
          </GreaterThan>
          <Dependency path="/partYearYonkersResident" />
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/standardOrNonStandardCd">
      <Name>MeF variable: nonstandard W2</Name>
      <Description>MeF Variable: the code for whether it is a standard or nonstandard Line 368 of
        the IRSW2 Schema</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <Dependency path="../isNonstandard" />
              </All>
            </When>
            <Then>
              <String>N</String>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <String>S</String>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/nonstandardOrCorrectedChoice">
      <Name>Nonstandard or corrected choice</Name>
      <Description>Whether the form W2 is nonstandard, corrected, both, or neither</Description>
      <Writable>
        <Enum optionsPath="/w2NonstandardCorrectedOptions" />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/isCorrected">
      <Name>W2 is corrected</Name>
      <Description>This is not a standard W2, it is marked as corrected</Description>
      <Export mef="true" />

      <Derived>
        <Any>
          <Equal>
            <Left>
              <Dependency path="../nonstandardOrCorrectedChoice" />
            </Left>
            <Right>
              <Enum optionsPath="/w2NonstandardCorrectedOptions">corrected</Enum>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Dependency path="../nonstandardOrCorrectedChoice" />
            </Left>
            <Right>
              <Enum optionsPath="/w2NonstandardCorrectedOptions">both</Enum>
            </Right>
          </Equal>
        </Any>
      </Derived>
    </Fact>


    <Fact path="/formW2s/*/isNonstandard">
      <Name>W2 is nonstandard</Name>
      <Description>This is not a standard W2, it is marked as nonstandard</Description>
      <Derived>
        <Any>
          <Equal>
            <Left>
              <Dependency path="../nonstandardOrCorrectedChoice" />
            </Left>
            <Right>
              <Enum optionsPath="/w2NonstandardCorrectedOptions">nonstandard</Enum>
            </Right>
          </Equal>
          <Equal>
            <Left>
              <Dependency path="../nonstandardOrCorrectedChoice" />
            </Left>
            <Right>
              <Enum optionsPath="/w2NonstandardCorrectedOptions">both</Enum>
            </Right>
          </Equal>
        </Any>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/belongsToPrimaryFiler">
      <Name>W2 belongs to primary filer</Name>
      <Description>The W2 belongs to the primary filer</Description>
      <Derived>
        <Equal>
          <Left>
            <Dependency module="filers" path="../filer" />
          </Left>
          <Right>
            <Dependency module="filers" path="/primaryFiler" />
          </Right>
        </Equal>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/belongsToSecondaryFiler">
      <Name>W2 belongs to secondary filer</Name>
      <Description>The W2 belongs to the secondary filer</Description>

      <Derived>
        <Equal>
          <Left>
            <Dependency module="filers" path="../filer" />
          </Left>
          <Right>
            <Dependency module="filers" path="/secondaryFiler" />
          </Right>
        </Equal>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/secondaryFilerUsedWithoutMFJ">
      <Name>Secondary filer has W2s when primary filer is not filing jointly</Name>
      <Description>Whether secondary filer has W2s when primary filer is not filing jointly</Description>

      <Derived>
        <All>
          <Not>
            <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
          </Not>
          <Dependency path="../belongsToSecondaryFiler" />
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/secondaryFilerUsedWithoutMFJ">
      <Name>Secondary filer has W2s when primary filer is not filing jointly</Name>
      <Description>Whether secondary filer has W2s when primary filer is not filing jointly</Description>
      <BlockSubmissionOnTrue />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/formW2s/*/secondaryFilerUsedWithoutMFJ" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/hasRRTACodes">
      <Name>Has Railroad Retirement Tax Act (RRTA) Codes</Name>
      <Description>Do any Railroad Retirement Tax Act (RRTA) codes show up in box 14 on this W2?</Description>
      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/formW2s/*/box17GreaterThanBox16">
      <Description>
        W-2 has a Box 17 (State income tax) value that is greater than the Box 16 (State wages,
        tips, etc)
        value.

        Used to power a W-2 validation: State income tax cannot exceed state income amount.

        Uses the writeable
        facts for these boxes and explicitly checks for completion,
        as the derived box values default to 0.
        Filling out a
        value for box 17 but not box 16 would then erroneously trigger this validation,
        for example, if using the derived
        facts for these boxes.

        We only want to show this validation if the taxpayer entered a value for both
        boxes.
      </Description>

      <Derived>
        <All>
          <IsComplete>
            <Dependency path="../writableStateWages" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../writableStateWithholding" />
          </IsComplete>
          <GreaterThan>
            <Left>
              <Dependency path="../writableStateWithholding" />
            </Left>
            <Right>
              <Dependency path="../writableStateWages" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2s/*/box19GreaterThanBox18">
      <Description>
        True if W2 has a value for Box 19 (Local income tax) and Box 18 (Local wages, tips, etc),
        and the
        value of Box 19 is greater than Box 18.

        Derived box values default to 0, so this fact explicitly checks for
        completion; it's false
        if either box is incomplete.

        Used to power a W-2 validation: Local income tax cannot exceed
        local income amount.
      </Description>

      <Derived>
        <All>
          <IsComplete>
            <Dependency path="../writableLocalWages" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../writableLocalWithholding" />
          </IsComplete>
          <GreaterThan>
            <Left>
              <Dependency path="../writableLocalWithholding" />
            </Left>
            <Right>
              <Dependency path="../writableLocalWages" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/formW2Withholding">
      <Name>Form W-2 withholding</Name>
      <Description>Federal income tax withheld from wages, as reported on line 25a of Form 1040.</Description>
      <Export downstreamFacts="true" mef="true" />
      <Derived>
        <Round>
          <CollectionSum>
            <Dependency path="/formW2s/*/federalWithholding" />
          </CollectionSum>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/wages">
      <Name>Wages, salaries, tips, etc.</Name>
      <Description>Wage income to report on line 1a of Form 1040.</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <CollectionSum>
            <Dependency path="/formW2s/*/wages" />
          </CollectionSum>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerWages">
      <Name>Primary Filer wages, salaries, tips, etc.</Name>
      <Description>Wage income to use in calculating earned income for CDCC</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <CollectionSum>
          <Dependency path="/primaryFilerW2s/*/wages" />
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerHasW2WagesGreaterThan0">
      <Name> Primary filer has W2 Wages greater than 0</Name>
      <Description>Whether primary filer has wages greater than 0</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/primaryFilerWages" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerTotalHsaContributionsFromW2s">
      <Description>Primary filers total HSA contributions reported on their W-2s</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <CollectionSum>
          <Round>
            <Dependency path="/primaryFilerW2s/*/employerHsaContributionsRounded" />
          </Round>
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/hasPrimaryFilerHsaContributionsFromW2s">
      <Description>Whether the primary filer has HSA contributions reported on their W-2s</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/primaryFilerTotalHsaContributionsFromW2s" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerWages">
      <Name>Secondary filer wages, salaries, tips, etc.</Name>
      <Description>Wage income to use in calculating earned income for CDCC</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <CollectionSum>
          <Dependency path="/secondaryFilerW2s/*/wages" />
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerHasW2WagesGreaterThan0">
      <Name> Secondary filer has W2 wages greater than 0</Name>
      <Description>Whether secondary filer has wages greater than 0</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/secondaryFilerWages" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerTotalHsaContributionsFromW2s">
      <Description>Primary filers total HSA contributions reported on their W-2s</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <CollectionSum>
          <Dependency path="/secondaryFilerW2s/*/employerHsaContributionsRounded" />
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/hasSecondaryFilerHsaContributionsFromW2s">
      <Description>Whether the secondary filer has HSA contributions reported on their W-2s</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/secondaryFilerTotalHsaContributionsFromW2s" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/totalHsaContributionsOnW2s">
      <Description>The total amount of HSA contributions reported on the TPs W2s</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
            </When>
            <Then>
              <Add>
                <Dependency path="/primaryFilerTotalHsaContributionsFromW2s" />
                <Dependency path="/secondaryFilerTotalHsaContributionsFromW2s" />
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency path="/primaryFilerTotalHsaContributionsFromW2s" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/hasHsaContributionsOnW2">
      <Description>Whether we already know the TP has HSA contributions reported on their W2</Description>
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency module="formW2s" path="/totalHsaContributionsOnW2s" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/socialSecurityTaxesWithheld">
      <Name>Social Security taxes withheld</Name>
      <Description>The amount of social security and medicare tax withheld, as defined by 24(d)(2).</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <Add>
            <CollectionSum>
              <Dependency path="/formW2s/*/oasdiWithholding" />
            </CollectionSum>
            <CollectionSum>
              <Dependency path="/formW2s/*/medicareWithholding" />
            </CollectionSum>
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerW2s">
      <Name>Primary Filer W2s</Name>
      <Description>The W2s that belong to the primary filer</Description>
      <Derived>
        <Filter path="/formW2s">
          <Dependency path="belongsToPrimaryFiler" />
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerW2sCount">
      <Name>Primary Filter W2s Count</Name>
      <Description>How many W2s does the primary filer have?</Description>
      <Derived>
        <CollectionSize>
          <Dependency path="/primaryFilerW2s" />
        </CollectionSize>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerTotalOasdiWagesForKnockout">
      <Name>Primary Filer Total Social Security Wages</Name>
      <Description>Sum of Social Security Wages across Primary Filer W2s</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/primaryFilerW2s/*/oasdiWagesForKnockoutCalculation" />
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerW2s">
      <Name>Secondary Filer W2s</Name>
      <Description>The W2s that belong to the secondary filer</Description>
      <Derived>
        <Filter path="/formW2s">
          <Dependency path="belongsToSecondaryFiler" />
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerW2sCount">
      <Name>Secondary Filter W2s Count</Name>
      <Description>How many W2s does the secondary filer have?</Description>
      <Derived>
        <CollectionSize>
          <Dependency path="/secondaryFilerW2s" />
        </CollectionSize>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerTotalOasdiWagesForKnockout">
      <Name>Secondary Filer Total Social Security Wages</Name>
      <Description>Sum of Social Security Wages across Secondary Filer W2s</Description>
      <Derived>
        <CollectionSum>
          <Dependency path="/secondaryFilerW2s/*/oasdiWagesForKnockoutCalculation" />
        </CollectionSum>
      </Derived>
    </Fact>

    <!-- Combat pay section - may belong in its own module -->

    <Fact path="/someFilerHasCombatPay">
      <Name>Some filer has combat pay</Name>
      <Description>Either the primary filer or their MFJ spouse has combat pay on at least one of
        their W2s.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Any>
          <Dependency path="/MFJSpouseHasCombatPay" />
          <Dependency path="/primaryFilerHasCombatPay" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/onlyOneFilerHasCombatPay">
      <Name>Only one filer has combat pay</Name>
      <Description>Either the primary filer or their MFJ spouse (if MFJ) has combat pay on one of
        their W2s.</Description>

      <Derived>
        <Any>
          <All>
            <Not>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
            </Not>
            <Dependency path="/primaryFilerHasCombatPay" />
          </All>
          <Any>
            <All>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
              <Dependency path="/MFJSpouseHasCombatPay" />
              <Not>
                <Dependency path="/primaryFilerHasCombatPay" />
              </Not>
            </All>
            <All>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
              <Not>
                <Dependency path="/MFJSpouseHasCombatPay" />
              </Not>
              <Dependency path="/primaryFilerHasCombatPay" />
            </All>
          </Any>
        </Any>
      </Derived>
    </Fact>

    <Fact path="/MFJSpouseHasCombatPay">
      <Name>MFJ Spouse has combat pay</Name>
      <Description>Whether a TP has an MFJ spouse and that MFJ spouse has combat pay on at least one
        of their W2s</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/MFJSpouseCombatPay" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/MFJSpouseCombatPay">
      <Name>MFJ Spouse Combat Pay</Name>
      <Description>The amount of combat pay an MFJ spouse has on all of their W2s combined. Returns
        zero if filing
        status
        is not MFJ</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
            </When>
            <Then>
              <CollectionSum>
                <Dependency path="/secondaryFilerW2s/*/combatPay" />
              </CollectionSum>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/onlyMFJSpouseHasCombatPay">
      <Name>Only MFJ Spouse has combat pay</Name>
      <Description>Whether or not ONLY the MFJ Spouse has combat pay on at least one of their W2s
        and the primary does
        not</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <Dependency path="/MFJSpouseHasCombatPay" />
          <Not>
            <Dependency path="/primaryFilerHasCombatPay" />
          </Not>
        </All>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerHasCombatPay">
      <Name>TP has combat pay</Name>
      <Description>Whether a TP has combat pay on at least one of their W2s</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/primaryFilerCombatPay" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerCombatPay">
      <Name>TP combat pay</Name>
      <Description>The amount of combat pay for the primary filer reported on their W2s.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <CollectionSum>
          <Dependency path="/primaryFilerW2s/*/combatPay" />
        </CollectionSum>
      </Derived>
    </Fact>

    <Fact path="/onlyPrimaryFilerHasCombatPay">
      <Name>Only primary filer has combat pay</Name>
      <Description>Whether or not ONLY the primary TP has combat pay on at least one of their W2s
        and the secondary
        filer
        does not have combat pay</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <Dependency path="/primaryFilerHasCombatPay" />
          <Not>
            <Dependency path="/MFJSpouseHasCombatPay" />
          </Not>
        </All>
      </Derived>
    </Fact>

    <Fact path="/bothFilersHasCombatPay">
      <Name>Do both filers have combat pay?</Name>
      <Description>Whether the primary filer and their MFJ spouse has combat pay on at least one of
        their W2s.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <Dependency path="/MFJSpouseHasCombatPay" />
          <Dependency path="/primaryFilerHasCombatPay" />
        </All>
      </Derived>
    </Fact>

    <Fact path="/bothFilersCombatPay">
      <Name>Both filers combat pay</Name>
      <Description>The combined amount of combat pay from both primary filter and MFJ spouse.</Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerCombatPay" />
          <Dependency path="/MFJSpouseCombatPay" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/combatPayAmount">
      <Name>Combat Pay if Elected</Name>
      <Description>The combat pay for line 1i, taking into account whether the user wants to declare
        it or not.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <All>
                  <Dependency path="/onlyPrimaryFilerHasCombatPay" />
                  <Equal>
                    <Left>
                      <Dependency module="eitc" path="/combatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">usePrimaryCombatPay</Enum>
                    </Right>
                  </Equal>
                </All>
              </When>
              <Then>
                <Dependency path="/primaryFilerCombatPay" />
              </Then>
            </Case>
            <Case>
              <When>
                <All>
                  <Dependency path="/onlyMFJSpouseHasCombatPay" />
                  <Equal>
                    <Left>
                      <Dependency module="eitc" path="/combatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useSpouseCombatPay</Enum>
                    </Right>
                  </Equal>
                </All>
              </When>
              <Then>
                <Dependency path="/MFJSpouseCombatPay" />
              </Then>
            </Case>
            <Case>
              <When>
                <All>
                  <Dependency path="/bothFilersHasCombatPay" />
                  <Equal>
                    <Left>
                      <Dependency module="eitc" path="/combatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useBothCombatPay</Enum>
                    </Right>
                  </Equal>
                </All>
              </When>
              <Then>
                <Add>
                  <Dependency path="/MFJSpouseCombatPay" />
                  <Dependency path="/primaryFilerCombatPay" />
                </Add>
              </Then>
            </Case>
            <Case>
              <When>
                <All>
                  <Dependency path="/bothFilersHasCombatPay" />
                  <Equal>
                    <Left>
                      <Dependency module="eitc" path="/combatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">usePrimaryNotSpouseCombatPay</Enum>
                    </Right>
                  </Equal>
                </All>
              </When>
              <Then>
                <Dependency path="/primaryFilerCombatPay" />
              </Then>
            </Case>
            <Case>
              <When>
                <All>
                  <Dependency path="/bothFilersHasCombatPay" />
                  <Equal>
                    <Left>
                      <Dependency module="eitc" path="/combatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useSpouseNotPrimaryCombatPay</Enum>
                    </Right>
                  </Equal>
                </All>
              </When>
              <Then>
                <Dependency path="/MFJSpouseCombatPay" />
              </Then>
            </Case>
            <Case>
              <When>
                <!-- There has not been a combat pay election, or the user chose "noCombatPay" -->
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/allCombatPay">
      <Name>Nontaxable combat pay</Name>
      <Description>Nontaxable combat pay. Note: don't go including this on line 1i of the 1040; that
        box should only be
        filled in if the taxpayer elects to include combat pay as earned income for purposes of
        calculating the Earned
        Income Tax Credit or Child and Dependent Care Credit.

        This value is reported on line 18b of schedule 8812, used
        to calculate ACTC.

        Additionally, be
        careful to appropriately separate spouse and taxpayer combat pay if MFJ. The
        TP can elect to
        include neither,
        either, or both of their combat pay on line 1i.</Description>
      <Export downstreamFacts="true" mef="true" />
      <Derived>
        <Round>
          <CollectionSum>
            <Dependency path="/formW2s/*/combatPay" />
          </CollectionSum>
        </Round>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
